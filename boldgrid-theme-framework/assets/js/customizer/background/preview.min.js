import PaletteSelector from"../color/palette-selector";import ColorPreview from"../color/preview";const api=wp.customize;export class Preview{constructor(){this.selector=new PaletteSelector,this.colorPreview=(new ColorPreview).init(),this.$body=$("body")}init(){return $(()=>this._onLoad()),this}setImage(){if("image"===api("boldgrid_background_type")()){const o=api("background_image")();let e="";o&&api("bgtfw_background_overlay")()?e=this._getOverlayCss(o):o&&(e=`url("${o}")`),this.$body.css("background-image",e)}}setBodyClasses(){"image"===api("boldgrid_background_type")()&&api("background_image")()&&api("bgtfw_background_overlay")()&&this.colorPreview.outputColor("bgtfw_background_overlay_color","body",["background-color","text-default"])}_onLoad(){this._setupImageChange()}_getOverlayCss(o){const e=this.selector.getColor(api("bgtfw_background_overlay_color")()),r=api("bgtfw_background_overlay_alpha")(),t=parent.net.brehaut.Color(e).setAlpha(r).toString();return`linear-gradient(to left, ${t}, ${t}), url("${o}")`}_setupImageChange(){api("bgtfw_background_overlay_alpha","bgtfw_background_overlay","bgtfw_background_overlay_color","background_image","boldgrid_background_type",(...o)=>{o.map(o=>o.bind(()=>{this.setImage(),this.setBodyClasses()}))})}}