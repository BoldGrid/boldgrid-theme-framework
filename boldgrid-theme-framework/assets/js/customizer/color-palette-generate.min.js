var BOLDGRID=BOLDGRID||{};BOLDGRID.COLOR_PALETTE=BOLDGRID.COLOR_PALETTE||{},BOLDGRID.COLOR_PALETTE.Generate=BOLDGRID.COLOR_PALETTE.Generate||{},function(e){"use strict";var t=BOLDGRID.COLOR_PALETTE.Generate,n={};t.palette_collection=BOLDGRIDColorPalettes.palettes;var a=["fiveToneAScheme","fiveToneBScheme","fiveToneCScheme","fiveToneDScheme","fiveToneEScheme","neutralScheme","neutralScheme","neutralScheme","analogousScheme","analogousScheme","analogousScheme"],r=["monochromatic","intesity_and_hue","complementaryScheme","splitComplementaryScheme","splitComplementaryCWScheme","triadicScheme","tetradicScheme"],o=["compliment","blend","copy"],i=["saturateByAmount","lightenByAmount","shiftHue"],h=["#FFFFF2","#FBF5E6","#FFFFFF","#F6F9ED","#FDFDF0","#EBECE4","#ECF1EF","#FFFFFE","#FCF6CF","#FEFFEF","#FFFFFD","#FFFFF3","#FEF1E9","#FEF6E4","#EEF3E2","#292929","#4d4d4d","#1a1a1a"];t.get_random_color=function(){for(var e="0123456789ABCDEF".split(""),t="#",n=0;n<6;n++)t+=e[Math.floor(16*Math.random())];return t},t.randomArrayElement=function(e){return e[Math.floor(Math.random()*e.length)]},t.generateNeutralColor=function(e){var n,a,r=Math.random(),o=null,i=.5,u=.9;return r>i?(n=t.randomArrayElement(e),a=net.brehaut.Color(n),o=a.setLightness(u).toCSS()):o=t.randomArrayElement(h),o},t.colorDiff=function(e,t){e=net.brehaut.Color(e).toHSL(),t=net.brehaut.Color(t).toHSL();var n=e.hue-t.hue,a=e.saturation-t.saturation,r=e.lightness-t.lightness,o=Math.abs(n)/360,i=Math.abs(a),h=Math.abs(r),u=o+i+h;return{hue:n,saturationDiff:a,lightnessDiff:r,totalPercentageDiff:u}},t.findMatches=function(t){var n={};return e.each(t,function(a,r){e.each(t,function(e,t){t==r&&e!==a&&(n[t]||(n[t]=[]),-1===n[t].indexOf(a)&&n[t].push(a),-1===n[t].indexOf(e)&&n[t].push(e))})}),n},t.arrayMove=function(e,t,n){if(t>=e.length)for(var a=t-e.length;a--+1;)e.push(void 0);return e.splice(t,0,e.splice(n,1)[0]),e},t.findRelations=function(n){var a,r=[];return a=t.findMatches(n),!1===e.isEmptyObject(a)&&e.each(a,function(){r.push({type:"match",values:this})}),r},t.determineRelations=function(n){var a={},r=[],o=t.findRelations(n.samplePalette);return e.each(o,function(t){var a=!0;e.each(this.values,function(){if(n.partialPalette[this])return a=!1,!1}),a&&r.push(this)}),r.length?a={type:"samplePalette",relationsData:r}:e.each(n.additionalSamplePalattes,function(){if(r=t.findRelations(this),r.length)return a={type:"additionalSamplePalattes",relationsData:r},!1}),a},t.applyRelationships=function(t,n,a){var r=t.slice(0);return e.each(n.relationsData,function(){var t=this,n=!1;"match"==t.type&&(e.each(t.values,function(){var e=a.indexOf(this);-1!==e&&(n=this)}),n===!1&&(n=t.values[Math.floor(Math.random()*t.values.length)]),e.each(t.values,function(){r[this]=r[n]}))}),r},t.findLockedIndexes=function(t){var n=[];return e.each(t,function(e){this&&n.push(e)}),n},t.determineRelationalCount=function(e,t){var n;return n=2/3,"additionalSamplePalattes"==e&&(n=1/3),Math.floor(t*n)},t.findPalettesByColor=function(n){var a,r,o=[];return r=function(e){return t.palette_collection[this.paletteIndex].slice(0)},e.each(t.palette_collection,function(a){e.each(this,function(e){var i=t.colorDiff(this,n);if(!(i.hue>16)){var h={paletteIndex:a,colorIndex:e,distance:i,getPalette:r};o.push(h)}})}),a=function(e,t){return Math.abs(e.distance.totalPercentageDiff)>Math.abs(t.distance.totalPercentageDiff)?1:Math.abs(e.distance.totalPercentageDiff)<Math.abs(t.distance.totalPercentageDiff)?-1:0},o.sort(a),o},t.generate_palette_collection=function(e,n){n||(n=5);for(var a=t.determineRelations(e),r=t.findLockedIndexes(e.partialPalette),o=t.determineRelationalCount(a.type,n),i=[],h=0;h<n;h++){var u=t.generate_palette(e);if("object"==typeof u&&u.length){var l="samplePalette"==a.type&&h<o||"additionalSamplePalattes"==a.type&&h>=n-o;l&&(u=t.applyRelationships(u,a,r)),u=t.fixLockedIndex(u,e.partialPalette),i.push(u)}}return i},t.fixLockedIndex=function(t,n){return e.each(n,function(e){this&&(t[e]=this)}),t},t.generate_palette=function(o){var i=[],h=t.partial_palette_into_colors_palette(o.partialPalette),u=t.is_palette_empty(h.palette);if(u)i=t.get_palette_from_static_list(h.palette);else if(h.generateKeys.length>1){var l=t.generate_palette_from_partial(h.palette);i=t.randomize_palette(l,h.unchangedKeys)}else{var s=h.palette[h.generateKeys[0]];if(s.toCSS()!==n.color&&(n.color=s.toCSS(),n.palettes=t.findPalettesByColor(n.color),n.paletteCounter=0),n.palettes[n.paletteCounter])i=n.palettes[n.paletteCounter].getPalette(),i=t.arrayMove(i,h.generateKeys[0],this.colorIndex),i=t.truncate_generated_palette(i,h.palette),n.paletteCounter++;else{var c=Math.floor(3*Math.random())+1;if(1==c){var f=r[Math.floor(Math.random()*r.length)];i=t.color_palettes[f](s)}else if(2==c){var p=a[Math.floor(Math.random()*a.length)];i=s[p]()}else{var m=t.random_array(4,5);m.unshift(0),i=s.schemeFromDegrees(m)}i=t.randomize_palette(i,[0]),i=t.format_palette_to_unchanged(i,h.generateKeys[0]),i=t.truncate_generated_palette(i,h.palette)}}var d=i.slice(0);return e.each(h.unchangedKeys,function(){d[this]=o.partialPalette[this]}),d},t.truncate_generated_palette=function(e,t){for(var n=[],a=0;a<t.length;a++)n.push(e[a]);return n},t.format_palette_to_unchanged=function(t,n){var a=t[0],r={};return r[n]=a,r[0]=t[n],e.each(t,function(e){0!==e&&e!==n&&(r[e]=this)}),r=e.map(r,function(e,t){return[e]})},t.partial_palette_into_colors_palette=function(t){var n=[],a=[],r=[];return e.each(t,function(e){if(this){var t=net.brehaut.Color(this);t.getLightness()<.9&&t.getLightness()>.1&&t.getSaturation()>.15?(n.push(t),r.push(e)):n.push(null),a.push(e)}else n.push(null)}),{palette:n,unchangedKeys:a,generateKeys:r}},t.get_palette_from_static_list=function(n){var a=[];return e.each([1,2],function(){var e=t.palette_collection[Math.floor(Math.random()*t.palette_collection.length)];if(e.length>=n.length)if(e.length>n.length)for(var r=0;r<n.length;r++)a.push(e[r]);else e.length===n.length&&(a=e);if(a.length)return!1}),a},t.is_palette_empty=function(t){var n=!0;return e.each(t,function(e){if(this)return n=!1,!1}),n},t.get_grey=function(){var e=net.brehaut.Color("#FFFFFF");return e.setBlue(0).setRed(0).setGreen(0).setLightness(Math.random()).toCSS()},t.color_array_to_css=function(t){var n=[];return e.each(t,function(e){e<5&&n.push(this.toCSS())}),n},t.generate_palette_from_partial=function(t){var n=[];e.each(t,function(e,t){t&&n.push(t)});var a=[];return e.each(t,function(e,t){if(t)a.push(t);else{var r,i=o[Math.floor(Math.random()*o.length)],h=n[Math.floor(Math.random()*n.length)],u=n[Math.floor(Math.random()*n.length)];r="compliment"==i?h.shiftHue(180):"blend"==i?h.blend(u,.5):h,a.push(r)}}),a},t.randomize_palette=function(t,n){var a=[];return e.each(t,function(e){if(e>=5)return!1;if("-1"!=n.indexOf(e))return void a.push(this.toCSS());for(var t=this,r=0;r<2;r++){var o,h=i[Math.floor(Math.random()*i.length)];o="shiftHue"==h?Math.floor(45*Math.random())+1-23:(Math.floor(20*Math.random())+1)/100,t=t[h](o),1==r&&a.push(t.toCSS())}}),a},t.random_array=function(e,t){for(var n=[],a=45*t,r=0;r<e;r++)n.push(Math.floor(Math.random()*a)+1-a/2);return n},t.color_palettes={monochromatic:function(e){var t=[];return t.push(e),t.push(e.lightenByAmount(.3)),t.push(e.darkenByAmount(.1)),t.push(e.saturateByAmount(.5)),t.push(e.lightenByAmount(.2)),t},intesity_and_hue:function(e){var t=[];return t.push(e),t.push(e.shiftHue(20).lightenByAmount(.15)),t.push(e.shiftHue(-20).darkenByAmount(.2)),t.push(e.shiftHue(-33).darkenByAmount(.25)),t.push(e.shiftHue(10).lightenByAmount(.05)),t},complementaryScheme:function(e){var t=[];return t.push(e),t.push(e.shiftHue(180)),t.push(e.shiftHue(180).lightenByAmount(.25)),t.push(e.darkenByAmount(.25)),t.push(e.lightenByAmount(.25)),t},splitComplementaryScheme:function(e){var t=[];return t.push(e),t.push(e.shiftHue(150)),t.push(e.shiftHue(320)),t.push(e.shiftHue(320).darkenByAmount(.25)),t.push(e.lightenByAmount(.25)),t},splitComplementaryCWScheme:function(e){var t=[];return t.push(e),t.push(e.shiftHue(60)),t.push(e.shiftHue(210)),t.push(e.darkenByAmount(.1)),t.push(e.shiftHue(60).darkenByAmount(.15)),t},triadicScheme:function(e){var t=[];return t.push(e),t.push(e.shiftHue(60)),t.push(e.shiftHue(240)),t.push(e.shiftHue(60).lightenByAmount(.2)),t.push(e.lightenByAmount(.15)),t},tetradicScheme:function(e){var t=[];return t.push(e),t.push(e.shiftHue(90)),t.push(e.shiftHue(180)),t.push(e.shiftHue(270)),t.push(e.saturateByAmount(-.25)),t}}}(jQuery);