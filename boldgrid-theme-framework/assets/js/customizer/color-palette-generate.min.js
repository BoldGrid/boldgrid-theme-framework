var BOLDGRID=BOLDGRID||{};BOLDGRID.COLOR_PALETTE=BOLDGRID.COLOR_PALETTE||{},BOLDGRID.COLOR_PALETTE.Generate=BOLDGRID.COLOR_PALETTE.Generate||{},function(e){"use strict";var t=BOLDGRID.COLOR_PALETTE.Generate,a={};t.palette_collection=BOLDGRIDColorPalettes.palettes;var n=["fiveToneAScheme","fiveToneBScheme","fiveToneCScheme","fiveToneDScheme","fiveToneEScheme","neutralScheme","neutralScheme","neutralScheme","analogousScheme","analogousScheme","analogousScheme"],r=["monochromatic","intesity_and_hue","complementaryScheme","splitComplementaryScheme","splitComplementaryCWScheme","triadicScheme","tetradicScheme"],o=["compliment","blend","copy"],i=["saturateByAmount","lightenByAmount","shiftHue"],h=["#FFFFF2","#FBF5E6","#FFFFFF","#F6F9ED","#FDFDF0","#EBECE4","#ECF1EF","#FFFFFE","#FCF6CF","#FEFFEF","#FFFFFD","#FFFFF3","#FEF1E9","#FEF6E4","#EEF3E2","#292929","#4d4d4d","#1a1a1a"];t.get_random_color=function(){for(var e="0123456789ABCDEF".split(""),t="#",a=0;6>a;a++)t+=e[Math.floor(16*Math.random())];return t},t.randomArrayElement=function(e){return e[Math.floor(Math.random()*e.length)]},t.generateNeutralColor=function(e){var a,n,r=Math.random(),o=null,i=.5,u=.9;return r>i?(a=t.randomArrayElement(e),n=net.brehaut.Color(a),o=n.setLightness(u).toCSS()):o=t.randomArrayElement(h),o},t.colorDiff=function(e,t){e=net.brehaut.Color(e).toHSL(),t=net.brehaut.Color(t).toHSL();var a=e.hue-t.hue,n=e.saturation-t.saturation,r=e.lightness-t.lightness,o=Math.abs(a)/360,i=Math.abs(n),h=Math.abs(r),u=o+i+h;return{hue:a,saturationDiff:n,lightnessDiff:r,totalPercentageDiff:u}},t.findMatches=function(t){var a={};return e.each(t,function(n,r){e.each(t,function(e,t){t==r&&e!==n&&(a[t]||(a[t]=[]),-1===a[t].indexOf(n)&&a[t].push(n),-1===a[t].indexOf(e)&&a[t].push(e))})}),a},t.arrayMove=function(e,t,a){if(t>=e.length)for(var n=t-e.length;n--+1;)e.push(void 0);return e.splice(t,0,e.splice(a,1)[0]),e},t.findRelations=function(a){var n,r=[];return n=t.findMatches(a),!1===e.isEmptyObject(n)&&e.each(n,function(){r.push({type:"match",values:this})}),r},t.determineRelations=function(a){var n={},r=[],o=t.findRelations(a.samplePalette);return e.each(o,function(t){var n=!0;e.each(this.values,function(){return a.partialPalette[this]?(n=!1,!1):void 0}),n&&r.push(this)}),r.length?n={type:"samplePalette",relationsData:r}:e.each(a.additionalSamplePalattes,function(){return r=t.findRelations(this),r.length?(n={type:"additionalSamplePalattes",relationsData:r},!1):void 0}),n},t.applyRelationships=function(t,a,n){var r=t.slice(0);return e.each(a.relationsData,function(){var t,a=this;"match"==a.type&&(e.each(a.values,function(){var e=n.indexOf(this);-1!==e&&(t=this)}),t||(t=a.values[Math.floor(Math.random()*a.values.length)]),e.each(a.values,function(){r[this]=r[t]}))}),r},t.findLockedIndexes=function(t){var a=[];return e.each(t,function(e){this&&a.push(e)}),a},t.determineRelationalCount=function(e,t){var a;return a=2/3,"additionalSamplePalattes"==e&&(a=1/3),Math.floor(t*a)},t.findPalettesByColor=function(a){var n,r,o=[];return r=function(e){return t.palette_collection[this.paletteIndex].slice(0)},e.each(t.palette_collection,function(n){e.each(this,function(e){var i=t.colorDiff(this,a);if(!(i.hue>16)){var h={paletteIndex:n,colorIndex:e,distance:i,getPalette:r};o.push(h)}})}),n=function(e,t){return Math.abs(e.distance.totalPercentageDiff)>Math.abs(t.distance.totalPercentageDiff)?1:Math.abs(e.distance.totalPercentageDiff)<Math.abs(t.distance.totalPercentageDiff)?-1:0},o.sort(n),o},t.generate_palette_collection=function(e,a){a||(a=5);for(var n=t.determineRelations(e),r=t.findLockedIndexes(e.partialPalette),o=t.determineRelationalCount(n.type,a),i=[],h=0;a>h;h++){var u=t.generate_palette(e);if("object"==typeof u&&u.length){var l="samplePalette"==n.type&&o>h||"additionalSamplePalattes"==n.type&&h>=a-o;l&&(u=t.applyRelationships(u,n,r)),i.push(u)}}return i},t.generate_palette=function(o){var i=[],h=t.partial_palette_into_colors_palette(o.partialPalette),u=t.is_palette_empty(h.palette);if(u)i=t.get_palette_from_static_list(h.palette);else if(h.generateKeys.length>1){var l=t.generate_palette_from_partial(h.palette);i=t.randomize_palette(l,h.unchangedKeys)}else{var s=h.palette[h.generateKeys[0]];if(s.toCSS()!==a.color&&(a.color=s.toCSS(),a.palettes=t.findPalettesByColor(a.color),a.paletteCounter=0),a.palettes[a.paletteCounter])i=a.palettes[a.paletteCounter].getPalette(),i=t.arrayMove(i,h.generateKeys[0],this.colorIndex),i=t.truncate_generated_palette(i,h.palette),a.paletteCounter++;else{var c=Math.floor(3*Math.random())+1;if(1==c){var f=r[Math.floor(Math.random()*r.length)];i=t.color_palettes[f](s)}else if(2==c){var p=n[Math.floor(Math.random()*n.length)];i=s[p]()}else{var m=t.random_array(4,5);m.unshift(0),i=s.schemeFromDegrees(m)}i=t.randomize_palette(i,[0]),i=t.format_palette_to_unchanged(i,h.generateKeys[0]),i=t.truncate_generated_palette(i,h.palette)}}var d=i.slice(0);return e.each(h.unchangedKeys,function(){d[this]=o.partialPalette[this]}),d},t.truncate_generated_palette=function(e,t){for(var a=[],n=0;n<t.length;n++)a.push(e[n]);return a},t.format_palette_to_unchanged=function(t,a){var n=t[0],r={};return r[a]=n,r[0]=t[a],e.each(t,function(e){0!==e&&e!==a&&(r[e]=this)}),r=e.map(r,function(e,t){return[e]})},t.partial_palette_into_colors_palette=function(t){var a=[],n=[],r=[];return e.each(t,function(e){if(this){var t=net.brehaut.Color(this);t.getLightness()<.9&&t.getLightness()>.1&&t.getSaturation()>.15?(a.push(t),r.push(e)):a.push(null),n.push(e)}else a.push(null)}),{palette:a,unchangedKeys:n,generateKeys:r}},t.get_palette_from_static_list=function(a){var n=[];return e.each([1,2],function(){var e=t.palette_collection[Math.floor(Math.random()*t.palette_collection.length)];if(e.length>=a.length)if(e.length>a.length)for(var r=0;r<a.length;r++)n.push(e[r]);else e.length===a.length&&(n=e);return n.length?!1:void 0}),n},t.is_palette_empty=function(t){var a=!0;return e.each(t,function(e){return this?(a=!1,!1):void 0}),a},t.get_grey=function(){var e=net.brehaut.Color("#FFFFFF");return e.setBlue(0).setRed(0).setGreen(0).setLightness(Math.random()).toCSS()},t.color_array_to_css=function(t){var a=[];return e.each(t,function(e){5>e&&a.push(this.toCSS())}),a},t.generate_palette_from_partial=function(t){var a=[];e.each(t,function(e,t){t&&a.push(t)});var n=[];return e.each(t,function(e,t){if(t)n.push(t);else{var r,i=o[Math.floor(Math.random()*o.length)],h=a[Math.floor(Math.random()*a.length)],u=a[Math.floor(Math.random()*a.length)];r="compliment"==i?h.shiftHue(180):"blend"==i?h.blend(u,.5):h,n.push(r)}}),n},t.randomize_palette=function(t,a){var n=[];return e.each(t,function(e){if(e>=5)return!1;if("-1"!=a.indexOf(e))return void n.push(this.toCSS());for(var t=this,r=0;2>r;r++){var o,h=i[Math.floor(Math.random()*i.length)];o="shiftHue"==h?Math.floor(45*Math.random())+1-23:(Math.floor(20*Math.random())+1)/100,t=t[h](o),1==r&&n.push(t.toCSS())}}),n},t.random_array=function(e,t){for(var a=[],n=45*t,r=0;e>r;r++)a.push(Math.floor(Math.random()*n)+1-n/2);return a},t.color_palettes={monochromatic:function(e){var t=[];return t.push(e),t.push(e.lightenByAmount(.3)),t.push(e.darkenByAmount(.1)),t.push(e.saturateByAmount(.5)),t.push(e.lightenByAmount(.2)),t},intesity_and_hue:function(e){var t=[];return t.push(e),t.push(e.shiftHue(20).lightenByAmount(.15)),t.push(e.shiftHue(-20).darkenByAmount(.2)),t.push(e.shiftHue(-33).darkenByAmount(.25)),t.push(e.shiftHue(10).lightenByAmount(.05)),t},complementaryScheme:function(e){var t=[];return t.push(e),t.push(e.shiftHue(180)),t.push(e.shiftHue(180).lightenByAmount(.25)),t.push(e.darkenByAmount(.25)),t.push(e.lightenByAmount(.25)),t},splitComplementaryScheme:function(e){var t=[];return t.push(e),t.push(e.shiftHue(150)),t.push(e.shiftHue(320)),t.push(e.shiftHue(320).darkenByAmount(.25)),t.push(e.lightenByAmount(.25)),t},splitComplementaryCWScheme:function(e){var t=[];return t.push(e),t.push(e.shiftHue(60)),t.push(e.shiftHue(210)),t.push(e.darkenByAmount(.1)),t.push(e.shiftHue(60).darkenByAmount(.15)),t},triadicScheme:function(e){var t=[];return t.push(e),t.push(e.shiftHue(60)),t.push(e.shiftHue(240)),t.push(e.shiftHue(60).lightenByAmount(.2)),t.push(e.lightenByAmount(.15)),t},tetradicScheme:function(e){var t=[];return t.push(e),t.push(e.shiftHue(90)),t.push(e.shiftHue(180)),t.push(e.shiftHue(270)),t.push(e.saturateByAmount(-.25)),t}}}(jQuery);