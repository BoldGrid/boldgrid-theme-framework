var BOLDGRID=BOLDGRID||{};BOLDGRID.COLOR_PALETTE=BOLDGRID.COLOR_PALETTE||{},BOLDGRID.COLOR_PALETTE.Generate=BOLDGRID.COLOR_PALETTE.Generate||{},function(t){"use strict";var e=BOLDGRID.COLOR_PALETTE.Generate,n={};e.palette_collection=BOLDGRIDColorPalettes.palettes;var a=["fiveToneAScheme","fiveToneBScheme","fiveToneCScheme","fiveToneDScheme","fiveToneEScheme","neutralScheme","neutralScheme","neutralScheme","analogousScheme","analogousScheme","analogousScheme"],r=["monochromatic","intesity_and_hue","complementaryScheme","splitComplementaryScheme","splitComplementaryCWScheme","triadicScheme","tetradicScheme"],o=["compliment","blend","copy"],h=["saturateByAmount","lightenByAmount","shiftHue"],i=["#FFFFF2","#FBF5E6","#FFFFFF","#F6F9ED","#FDFDF0","#EBECE4","#ECF1EF","#FFFFFE","#FCF6CF","#FEFFEF","#FFFFFD","#FFFFF3","#FEF1E9","#FEF6E4","#EEF3E2","#292929","#4d4d4d","#1a1a1a"];e.get_random_color=function(){for(var t="0123456789ABCDEF".split(""),e="#",n=0;6>n;n++)e+=t[Math.floor(16*Math.random())];return e},e.randomArrayElement=function(t){return t[Math.floor(Math.random()*t.length)]},e.generateNeutralColor=function(t){var n,a,r=Math.random(),o=null,h=.5,u=.9;return r>h?(n=e.randomArrayElement(t),a=net.brehaut.Color(n),o=a.setLightness(u).toCSS()):o=e.randomArrayElement(i),o},e.colorDiff=function(t,e){t=net.brehaut.Color(t).toHSL(),e=net.brehaut.Color(e).toHSL();var n=t.hue-e.hue,a=t.saturation-e.saturation,r=t.lightness-e.lightness,o=Math.abs(n)/360,h=Math.abs(a),i=Math.abs(r),u=o+h+i;return{hue:n,saturationDiff:a,lightnessDiff:r,totalPercentageDiff:u}},e.findMatches=function(e){var n={};return t.each(e,function(a,r){t.each(e,function(t,e){e==r&&t!==a&&(n[e]||(n[e]=[]),-1===n[e].indexOf(a)&&n[e].push(a),-1===n[e].indexOf(t)&&n[e].push(t))})}),n},e.arrayMove=function(t,e,n){if(e>=t.length)for(var a=e-t.length;a--+1;)t.push(void 0);return t.splice(e,0,t.splice(n,1)[0]),t},e.findRelations=function(n){var a,r=[];return a=e.findMatches(n),!1===t.isEmptyObject(a)&&t.each(a,function(){r.push({type:"match",values:this})}),r},e.determineRelations=function(n){var a={},r=[],o=e.findRelations(n.samplePalette);return t.each(o,function(e){var a=!0;t.each(this.values,function(){return n.partialPalette[this]?(a=!1,!1):void 0}),a&&r.push(this)}),r.length?a={type:"samplePalette",relationsData:r}:t.each(n.additionalSamplePalattes,function(){return r=e.findRelations(this),r.length?(a={type:"additionalSamplePalattes",relationsData:r},!1):void 0}),a},e.applyRelationships=function(e,n,a){var r=e.slice(0);return t.each(n.relationsData,function(){var e,n=this;"match"==n.type&&(t.each(n.values,function(){var t=a.indexOf(this);-1!==t&&(e=this)}),e||(e=n.values[Math.floor(Math.random()*n.values.length)]),t.each(n.values,function(){r[this]=r[e]}))}),r},e.findLockedIndexes=function(e){var n=[];return t.each(e,function(t){this&&n.push(t)}),n},e.determineRelationalCount=function(t,e){var n;return n=2/3,"additionalSamplePalattes"==t&&(n=1/3),Math.floor(e*n)},e.findPalettesByColor=function(n){var a,r,o=[];return r=function(t){return e.palette_collection[this.paletteIndex].slice(0)},t.each(e.palette_collection,function(a){t.each(this,function(t){var h=e.colorDiff(this,n);if(!(h.hue>16)){var i={paletteIndex:a,colorIndex:t,distance:h,getPalette:r};o.push(i)}})}),a=function(t,e){return Math.abs(t.distance.totalPercentageDiff)>Math.abs(e.distance.totalPercentageDiff)?1:Math.abs(t.distance.totalPercentageDiff)<Math.abs(e.distance.totalPercentageDiff)?-1:0},o.sort(a),o},e.generate_palette_collection=function(t,n){n||(n=5);for(var a=e.determineRelations(t),r=e.findLockedIndexes(t.partialPalette),o=e.determineRelationalCount(a.type,n),h=[],i=0;n>i;i++){var u=e.generate_palette(t);if("object"==typeof u&&u.length){var l="samplePalette"==a.type&&o>i||"additionalSamplePalattes"==a.type&&i>=n-o;l&&(u=e.applyRelationships(u,a,r)),h.push(u)}}return h},e.generate_palette=function(o){var h=[],i=e.partial_palette_into_colors_palette(o.partialPalette),u=e.is_palette_empty(i.palette);if(u)h=e.get_palette_from_static_list(i.palette);else if(i.unchangedKeys.length>1){var l=e.generate_palette_from_partial(i.palette);h=e.randomize_palette(l,i.unchangedKeys)}else{var s=i.palette[i.unchangedKeys[0]];if(s.toCSS()!==n.color&&(n.color=s.toCSS(),n.palettes=e.findPalettesByColor(n.color),n.paletteCounter=0),n.palettes[n.paletteCounter])h=n.palettes[n.paletteCounter].getPalette(),h=e.arrayMove(h,i.unchangedKeys[0],this.colorIndex),n.paletteCounter++;else{var c=Math.floor(3*Math.random())+1;if(1==c){var f=r[Math.floor(Math.random()*r.length)];h=e.color_palettes[f](s)}else if(2==c){var p=a[Math.floor(Math.random()*a.length)];h=s[p]()}else{var m=e.random_array(4,5);m.unshift(0),h=s.schemeFromDegrees(m)}h=e.randomize_palette(h,[0]),h=e.format_palette_to_unchanged(h,i.unchangedKeys[0]),h=e.truncate_generated_palette(h,i.palette)}}var d=h.slice(0);return t.each(i.unchangedKeys,function(){d[this]=o.partialPalette[this]}),d},e.truncate_generated_palette=function(t,e){for(var n=[],a=0;a<e.length;a++)n.push(t[a]);return n},e.format_palette_to_unchanged=function(e,n){var a=e[0],r={};return r[n]=a,r[0]=e[n],t.each(e,function(t){0!==t&&t!==n&&(r[t]=this)}),r=t.map(r,function(t,e){return[t]})},e.partial_palette_into_colors_palette=function(e){var n=[],a=[];return t.each(e,function(t){if(this){var e=net.brehaut.Color(this);e.getLightness()<.9&&e.getLightness()>.1&&e.getSaturation()>.15?n.push(e):n.push(null),a.push(t)}else n.push(null)}),{palette:n,unchangedKeys:a}},e.get_palette_from_static_list=function(n){var a=[];return t.each([1,2],function(){var t=e.palette_collection[Math.floor(Math.random()*e.palette_collection.length)];if(t.length>=n.length)if(t.length>n.length)for(var r=0;r<n.length;r++)a.push(t[r]);else t.length===n.length&&(a=t);return a.length?!1:void 0}),a},e.is_palette_empty=function(e){var n=!0;return t.each(e,function(t){return this?(n=!1,!1):void 0}),n},e.get_grey=function(){var t=net.brehaut.Color("#FFFFFF");return t.setBlue(0).setRed(0).setGreen(0).setLightness(Math.random()).toCSS()},e.color_array_to_css=function(e){var n=[];return t.each(e,function(t){5>t&&n.push(this.toCSS())}),n},e.generate_palette_from_partial=function(e){var n=[];t.each(e,function(t,e){e&&n.push(e)});var a=[];return t.each(e,function(t,e){if(e)a.push(e);else{var r,h=o[Math.floor(Math.random()*o.length)],i=n[Math.floor(Math.random()*n.length)],u=n[Math.floor(Math.random()*n.length)];r="compliment"==h?i.shiftHue(180):"blend"==h?i.blend(u,.5):i,a.push(r)}}),a},e.randomize_palette=function(e,n){var a=[];return t.each(e,function(t){if(t>=5)return!1;if("-1"!=n.indexOf(t))return void a.push(this.toCSS());for(var e=this,r=0;2>r;r++){var o,i=h[Math.floor(Math.random()*h.length)];o="shiftHue"==i?Math.floor(45*Math.random())+1-23:(Math.floor(20*Math.random())+1)/100,e=e[i](o),1==r&&a.push(e.toCSS())}}),a},e.random_array=function(t,e){for(var n=[],a=45*e,r=0;t>r;r++)n.push(Math.floor(Math.random()*a)+1-a/2);return n},e.color_palettes={monochromatic:function(t){var e=[];return e.push(t),e.push(t.lightenByAmount(.3)),e.push(t.darkenByAmount(.1)),e.push(t.saturateByAmount(.5)),e.push(t.lightenByAmount(.2)),e},intesity_and_hue:function(t){var e=[];return e.push(t),e.push(t.shiftHue(20).lightenByAmount(.15)),e.push(t.shiftHue(-20).darkenByAmount(.2)),e.push(t.shiftHue(-33).darkenByAmount(.25)),e.push(t.shiftHue(10).lightenByAmount(.05)),e},complementaryScheme:function(t){var e=[];return e.push(t),e.push(t.shiftHue(180)),e.push(t.shiftHue(180).lightenByAmount(.25)),e.push(t.darkenByAmount(.25)),e.push(t.lightenByAmount(.25)),e},splitComplementaryScheme:function(t){var e=[];return e.push(t),e.push(t.shiftHue(150)),e.push(t.shiftHue(320)),e.push(t.shiftHue(320).darkenByAmount(.25)),e.push(t.lightenByAmount(.25)),e},splitComplementaryCWScheme:function(t){var e=[];return e.push(t),e.push(t.shiftHue(60)),e.push(t.shiftHue(210)),e.push(t.darkenByAmount(.1)),e.push(t.shiftHue(60).darkenByAmount(.15)),e},triadicScheme:function(t){var e=[];return e.push(t),e.push(t.shiftHue(60)),e.push(t.shiftHue(240)),e.push(t.shiftHue(60).lightenByAmount(.2)),e.push(t.lightenByAmount(.15)),e},tetradicScheme:function(t){var e=[];return e.push(t),e.push(t.shiftHue(90)),e.push(t.shiftHue(180)),e.push(t.shiftHue(270)),e.push(t.saturateByAmount(-.25)),e}}}(jQuery);