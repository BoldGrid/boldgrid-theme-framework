var BOLDGRID=BOLDGRID||{};BOLDGRID.COLOR_PALETTE=BOLDGRID.COLOR_PALETTE||{},BOLDGRID.COLOR_PALETTE.Modify=BOLDGRID.COLOR_PALETTE.Modify||{},function(e){"use strict";var t=e(window),a=BOLDGRID.COLOR_PALETTE.Modify,o=a;a.pickerCompileDelay=100,a.pendingCompile=!1,a.palette_generator=BOLDGRID.COLOR_PALETTE.Generate,a.generated_color_palettes=6,a.state=null,a.active_body_class="",a.first_update=!0,a.prelockNeutral=!1,a.themePalettes=[];var r=["#232323","#FFFFFF","#FF5F5F","#FFDBB8","#FFFFB2","#bad6b1","#99acbf","#cdb5e2"];e(function(){o.$palette_control_wrapper=e("#customize-control-boldgrid-color-palette"),o.$compiled_css_control=e("#customize-control-boldgrid_compiled_css input"),o.$color_picker_input=o.$palette_control_wrapper.find(".pluto-color-control"),o.$palette_option_field=o.$palette_control_wrapper.find(".palette-option-field"),o.generated_palettes_container=o.$palette_control_wrapper.find(".generated-palettes-container"),o.$accoridon_section_colors=e("#accordion-section-colors"),o.$paletteWrapper=o.$palette_control_wrapper.find(".boldgrid-color-palette-wrapper"),o.hasNeutral=o.$paletteWrapper.data("has-neutral"),o.numColors=o.$paletteWrapper.data("num-colors"),a.duplicate_modification_icons(),a.themePalettes=a.getThemePalettes(),a.bind_palette_duplicate_remove(),a.bind_palette_activation(),a.setup_color_picker(),a.setup_close_color_picker(),a.setup_palette_generation(),a.bind_generate_palette_action(),a.bind_help_section_visibility(),a.bind_help_link(),a.bindActiveColorClick(),a.setup_advanced_options(),a.bind_compile_done(),a.fetch_acceptable_palette_formats(),setTimeout(a.wp_picker_post_init,100)}),a.bind_help_section_visibility=function(){e(".accordion-section").on("click",function(){var t=e(".boldgrid-color-palette-help");o.$accoridon_section_colors.hasClass("open")&&!t.is(":visible")?t.show():!1===o.$accoridon_section_colors.hasClass("open")&&t.hide()})},a.get_previewer_body=function(){return e(wp.customize.previewer.container).find("iframe").last().contents().find("body")},a.addColorTransition=function(){var e=600,t=a.get_previewer_body();t.addClass("color-palette-transitions duration-long");var r=(new Date).getTime();o.lastTransitionTime=r,setTimeout(function(){o.lastTransitionTime===r&&t.removeClass("color-palette-transitions duration-long")},e)},a.setup_close_color_picker=function(){o.$close_palette_creator=e('<button type="button" class="button close-color-picker">Done</button>'),e(".boldgrid-color-palette-wrapper input[type=text].wp-color-picker").after(o.$close_palette_creator),o.$close_palette_creator.on("click",function(){e("body").click()})},a.getThemePalettes=function(){var t=[];return o.$palette_control_wrapper.find('.boldgrid-inactive-palette[data-copy-on-mod="1"]').each(function(){var a=[];e(this).find("[data-color]").each(function(){a.push(e(this).data("color"))}),o.hasNeutral&&a.splice(-1,1),t.push(a)}),t},a.setup_palette_generation=function(){o.$palette_control_wrapper.find(".palette-generator-button").on("click",function(){!1===o.$paletteWrapper.hasClass("palette-generate-mode")&&(o.hasNeutral&&o.prelockNeutral&&(o.$palette_control_wrapper.find(".boldgrid-active-palette .boldgrid-palette-colors:last").addClass("selected-for-generation"),a.sync_locks()),o.$paletteWrapper.addClass("palette-generate-mode"))}),o.$palette_control_wrapper.on("click",".palette-generate-mode .current-palette-wrapper .color-lock",function(t){t.stopPropagation();var a=e(this);o.$palette_control_wrapper.find(".boldgrid-active-palette li").eq(a.data("count")).toggleClass("selected-for-generation"),a.toggleClass("selected-for-generation")}),o.$palette_control_wrapper.find(".cancel-generated-palettes-button").on("click",function(t){t.stopPropagation();var a=e(this);o.$palette_control_wrapper.find(".boldgrid-active-palette[data-auto-generated]").removeAttr("data-auto-generated"),o.generated_palettes_container.empty(),a.closest(".palette-generate-mode").removeClass("palette-generate-mode").find(".selected-for-generation").removeClass("selected-for-generation")})},a.duplicate_modification_icons=function(){a.$icon_set=o.$palette_control_wrapper.find(".boldgrid-duplicate-dashicons").first(),a.$icon_set&&(a.$icon_set=a.$icon_set.clone())},a.setup_advanced_options=function(){o.$palette_control_wrapper.find(".boldgrid-advanced-options-content").hide(),o.$palette_control_wrapper.find(".boldgrid-advanced-options").on("click",function(e){e.stopPropagation()}),o.$palette_control_wrapper.find(".boldgrid-advanced-options-label").on("click",function(t){t.stopPropagation(),e(this).closest(".boldgrid-advanced-options").find(".boldgrid-advanced-options-content").stop().slideToggle()})},a.bind_generate_palette_action=function(){o.$palette_control_wrapper.find(".palette-generator-button").on("click",function(){var t=a.paletteData(),r=null;o.hasNeutral&&(t.samplePalette.splice(-1,1),r=t.partialPalette.splice(-1,1),r=r[0]);var l=BOLDGRID.COLOR_PALETTE.Generate.generate_palette_collection(t,a.generated_color_palettes);o.hasNeutral&&e.each(l,function(){r?this.push(r):this.push(a.palette_generator.generateNeutralColor(this))}),a.display_generated_palettes(l)})},a.display_generated_palettes=function(t){var r=o.generated_palettes_container.empty(),l=null;e.each(t,function(){o.hasNeutral&&(l=this[this.length-1]);var t=e('<div data-palette-wrapper="true"><ul><li class="boldgrid-palette-colors"></li></ul></div>'),n=t.find("ul").addClass("boldgrid-inactive-palette").attr("data-auto-generated","true").attr("data-neutral-color",l).attr("data-color-palette-format",a.get_random_format()),i=n.find("li");e.each(this,function(){var t=e("<span></span>").css("background-color",this).attr("data-color",!0);i.append(t)}),r.append(t)})},a.paletteData=function(){var t={samplePalette:[],partialPalette:[],additionalSamplePalattes:a.themePalettes};return o.$palette_control_wrapper.find(".boldgrid-active-palette .boldgrid-palette-colors").each(function(){var a=e(this);a.hasClass("selected-for-generation")?t.partialPalette.push(a.css("background-color")):t.partialPalette.push(null),t.samplePalette.push(a.css("background-color"))}),t},a.fetch_acceptable_palette_formats=function(){a.body_classes=o.$palette_control_wrapper.find(".boldgrid-color-palette-wrapper").data("color-formats"),"object"==typeof a.body_classes&&(a.body_classes=e.map(a.body_classes,function(e,t){return[e]}))},a.revert_current_selection=function(t){t.removeClass("current-palette-wrapper");var o=t.find("> ul");o.removeClass("boldgrid-active-palette").addClass("boldgrid-inactive-palette"),o.find(".boldgrid-duplicate-dashicons").remove();var r=e('<li class="boldgrid-palette-colors"></li>');o.find(".boldgrid-palette-colors:not(.ui-sortable-helper)").not(".ui-sortable-placeholder").each(function(){var t=e(this);if("absolute"!==t.css("position")){var a=e('<span data-color="true"></span>').css("background-color",t.css("background-color"));r.append(a)}}),t.find(".bg-lock-controls").remove(),r.append(a.$icon_set.clone()),o.find(".boldgrid-palette-colors").remove(),o.append(r),o.data("ui-sortable")&&o.sortable("disable")},a.bind_help_link=function(){o.$palette_control_wrapper.on("click",'[data-action="open-color-picker"]',function(e){e.stopPropagation();var t=o.$palette_control_wrapper.find(".boldgrid-active-palette .boldgrid-palette-colors:first");a.activate_color(null,t)})},a.sync_locks=function(){var t=o.$palette_control_wrapper.find(".bg-lock-controls .color-lock");t.removeClass("selected-for-generation"),o.$palette_control_wrapper.find(".boldgrid-active-palette .boldgrid-palette-colors").each(function(a){var o=e(this);o.hasClass("selected-for-generation")&&t.eq(a).addClass("selected-for-generation")})},a.activate_palette=function(t){a.addColorTransition(),o.$palette_control_wrapper.find(".wp-color-result").addClass("expanded-wp-colorpicker"),t.attr("data-auto-generated")&&(t=t.closest("div").clone().find("[data-auto-generated]"));var r=[];o.$palette_control_wrapper.find(".boldgrid-active-palette .boldgrid-palette-colors").each(function(t){var a=e(this);a.hasClass("selected-for-generation")&&r.push(t)}),t.find("span[data-color]").each(function(a){var o=e(this),l=o.css("background-color"),n="";r.indexOf(a)!==-1&&(n="selected-for-generation"),t.append('<li class="boldgrid-palette-colors '+n+' boldgrid-dashicon" style="background-color: '+l+'"></li>')}),t.append(a.$icon_set.clone()),t.find("li:first").remove();var l=t.closest("div").addClass("current-palette-wrapper").detach();o.$palette_control_wrapper.find(".boldgrid-color-palette-wrapper").prepend(l);var n=o.$palette_control_wrapper.find(".palette-action-buttons");n.removeClass("hidden").insertAfter(t),a.$color_picker.show(),o.$palette_control_wrapper.find(".boldgrid-active-palette").each(function(){var t=e(this);t.attr("data-auto-generated")?t.closest("div").remove():a.revert_current_selection(t.closest("div"))}),a.add_jquery_sortable(t),t.sortable("enable"),t.disableSelection(),t.removeClass("boldgrid-inactive-palette"),t.addClass("boldgrid-active-palette"),t.find("li").disableSelection();var i=e('<div class="bg-lock-controls"></div>');t.find("li").each(function(e){i.append('<div class="color-lock" data-count="'+e+'"><div class="lock unlock"><div class="top"></div><div class="mid"></div><div class="bottom"><div class="keyhole-top"></div><div class="keyhole-bottom"></div></div></div>')}),t.after(i),a.sync_locks(),a.first_update?a.first_update=!1:a.update_theme_option()},a.add_jquery_sortable=function(t){var r=[],l=null;t.sortable({items:".boldgrid-palette-colors",axis:"x",start:function(n,i){r=[],l=null,i.item&&(o.$palette_control_wrapper.find(".active-palette-section").removeClass("active-palette-section"),i.item.find("span").length||a.modify_palette_action(i.item.closest('[data-palette-wrapper="true"]')),i.placeholder.css("background-color",i.item.css("background-color")).css("visibility","visible"),t.find("li").not(i.helper).not(i.placeholder).each(function(t){var a=e(this);r.push(a.css("background-color")),a.is(i.item)&&(l=t)}))},change:function(a,o){var n=t.find("li").not(o.helper).not(o.item);n.each(function(t){var a=e(this),i=r[t];a.is(o.placeholder)?n.eq(l).css("background-color",i):l!==t&&n.eq(t).css("background-color",i)})},helper:"clone",stop:function(t,r){if(a.addColorTransition(),a.update_theme_option(),a.open_picker(),r.item){var l=r.item;if(!l.find("span").length){o.$palette_control_wrapper.find(".active-palette-section").removeClass("active-palette-section"),l.addClass("active-palette-section"),l.siblings().each(function(){var t=e(this);t.toggleClass("boldgrid-dashicon"),setTimeout(function(){t.toggleClass("boldgrid-dashicon")},15)});var n=l.closest(".boldgrid-color-palette-wrapper");a.preselect_active_color(n),a.sync_locks(),a.updateNeutralData()}}}})},a.format_current_palette_state=function(){var t=o.$palette_control_wrapper.find(".boldgrid-active-palette").first(),a={};a["active-palette"]=t.attr("data-color-palette-format"),a["active-palette-id"]=t.attr("data-palette-id"),a.palettes={},a.saved_palettes=[],o.active_body_class=a["active-palette"];var r=function(){var t=e(this),r={};r=t.hasClass("boldgrid-active-palette")?t.find("li.boldgrid-palette-colors"):t.find(".boldgrid-palette-colors > span");var l=[];r.not(o.hasNeutral?":last-of-type":"").each(function(){l.push(e(this).css("background-color"))});var n={format:t.attr("data-color-palette-format"),colors:l,"neutral-color":t.attr("data-neutral-color")};a.palettes[t.attr("data-color-palette-format")]=n,t.attr("data-copy-on-mod")||a.saved_palettes.push(n)};return o.$palette_control_wrapper.find("[data-color-palette-format]").not(t).not('[data-auto-generated="true"]').each(r),t.each(r),a},a.create_color_scss_file=function(t){var a="";a+="$palette-primary_1: null;$palette-primary_2: null;$palette-primary_3: null;$palette-primary_4: null;$palette-primary_5: null;$palette-primary-neutral-color: null;$text-contrast-palette-primary-1: null;$text-contrast-palette-primary-2: null;$text-contrast-palette-primary-3: null;$text-contrast-palette-primary-4: null;$text-contrast-palette-primary-5: null;$text-contrast-palette-primary-neutral-color: null;";var o="$colors: ";e.each(t.palettes,function(t){if(this.colors){var r=o;e.each(this.colors,function(e){var o=e+1;a+="$"+t+"_"+o.toString()+":"+this+";",r+="$"+t+"_"+o.toString()+" "}),r!==o&&(a+=r+";")}this["neutral-color"]&&(a+="$"+t+"-neutral-color:"+this["neutral-color"]+";")});var r=wp.customize("boldgrid_light_text").get(),l=wp.customize("boldgrid_dark_text").get();return a+="$light-text:"+r+";",a+="$dark-text:"+l+";","undefined"!=typeof BOLDGRIDSass.ButtonVariables&&(a+='$ubtn-namespace: "'+BOLDGRIDSass.ButtonVariables["ubtn-namespace"]+'";',a+="$ubtn-bgcolor: "+BOLDGRIDSass.ButtonVariables["ubtn-bgcolor"],a+="$ubtn-font-color: "+BOLDGRIDSass.ButtonVariables["ubtn-font-color"],a+="$ubtn-theme-color: "+BOLDGRIDSass.ButtonVariables["ubtn-bgcolor"].replace(/\$/g,"")),"undefined"!=typeof BOLDGRIDSass.ButtonExtends&&("undefined"!=typeof BOLDGRIDSass.ButtonExtends.primary&&(a+='$button-primary-classes: "'+BOLDGRIDSass.ButtonExtends.primary+'";'),"undefined"!=typeof BOLDGRIDSass.ButtonExtends.secondary&&(a+='$button-secondary-classes: "'+BOLDGRIDSass.ButtonExtends.secondary+'";')),a},a.update_theme_option=function(e){e=e||{},a.state=a.format_current_palette_state();var t=a.create_color_scss_file(a.state);a.compile(t+BOLDGRIDSass.ScssFormatFileContents,e)},a.compile=function(e,t){o.pendingCompile={content:e,options:t},a.doCompile()},a.doCompile=function(){var e=o.pendingCompile;e&&!BOLDGRID.Sass.processing&&(BOLDGRID.Sass.compile(e.content,e.options),o.pendingCompile=!1)},a.bind_palette_activation=function(){o.$palette_control_wrapper.on("click",".boldgrid-inactive-palette",function(){a.activate_palette(e(this))})},a.activate_color=function(t,l,n){var i;t?(i=e(this),t.stopPropagation()):i=l,!1===i.hasClass("active-palette-section")&&(o.hasNeutral&&i.is(".boldgrid-active-palette .boldgrid-palette-colors:last")?o.$color_picker_input.iris({palettes:r}):o.$color_picker_input.iris({palettes:!0}),a.modify_palette_action(i.closest('[data-palette-wrapper="true"]')),o.$palette_control_wrapper.find(".active-palette-section").removeClass("active-palette-section"),i.addClass("active-palette-section"),a.open_picker(),n&&o.pause_color_changes(),a.set_iris_color(i.css("background-color")))},a.pause_color_changes=function(){o.ignoreColorChange=!0,setTimeout(function(){o.ignoreColorChange=!1})},a.open_picker=function(){o.$palette_control_wrapper.find(".wp-picker-open").length||o.$palette_control_wrapper.find(".wp-color-result").click()},a.set_iris_color=function(e){var t=net.brehaut.Color(e);o.$color_picker_input.iris("color",t.toString())},a.updateNeutralData=function(){var e,t,a;e=!!o.$palette_control_wrapper.find(".boldgrid-active-palette").attr("data-neutral-color"),e&&(a=o.$palette_control_wrapper.find(".boldgrid-active-palette"),t=a.find(".boldgrid-palette-colors:last").css("background-color"),a.attr("data-neutral-color",t))},a.setup_color_picker=function(){var e={defaultColor:!1,change:function(e,t){if(o.fadeEffectInProgress)return!1;var r=t.color.toString();if(o.$palette_control_wrapper.find(".active-palette-section").css("background-color",r),a.updateNeutralData(),a.updateCustomPalettes(),!o.ignoreColorChange){a.last_refresh_time=(new Date).getTime();var l=a.last_refresh_time;setTimeout(function(){var e=l===a.last_refresh_time,t=o.most_recent_update+a.pickerCompileDelay<(new Date).getTime();(e||t)&&(a.update_theme_option(),o.most_recent_update=(new Date).getTime())},a.pickerCompileDelay,l)}},hide:!0,palettes:!0};o.$color_picker_input.wpColorPicker(e),a.$color_picker=o.$palette_control_wrapper.find(".wp-picker-container").hide(),a.createPickerPalettes(),a.bindCustomPalettes()},a.updateCustomPalettes=function(t,a){var r=o.$palette_control_wrapper.find(".secondary-colors .iris-palette");t&&a?r.eq(t).css("background-color",a):o.$palette_control_wrapper.find(".boldgrid-active-palette .boldgrid-palette-colors").each(function(t){r.eq(t).css("background-color",e(this).css("background-color"))})},a.createPickerPalettes=function(){for(var t=e('<div class="secondary-colors"></div>'),a=0;a<o.numColors;a++)t.append('<a class="iris-palette" tabindex="0"></a>');t.prependTo(o.$palette_control_wrapper.find(".iris-picker-inner"))},a.bindCustomPalettes=function(){o.$palette_control_wrapper.find(".secondary-colors .iris-palette").on("click",function(){a.set_iris_color(e(this).css("background-color"))})},a.preselect_active_color=function(e){a.set_iris_color(e.find(".active-palette-section").css("background-color"))},a.bind_palette_duplicate_remove=function(){o.$palette_control_wrapper.on("click",".boldgrid-copy-palette, .boldgrid-remove-palette",function(t){t.stopPropagation();var o=e(this),r=o.closest('[data-palette-wrapper="true"]'),l=!0;o.hasClass("boldgrid-copy-palette")&&(l=!1),l?a.remove_palette(r):a.copy_palette(r)})},a.remove_palette=function(e){e.find(".boldgrid-inactive-palette").length&&(e.remove(),a.state=a.format_current_palette_state(),a.update_palette_settings())},a.modify_palette_action=function(e){e.find('[data-copy-on-mod="1"]').length&&a.copy_palette(e)},a.copy_palette=function(e){var t=e.find(".boldgrid-active-palette");if(t.length){var o=e.clone(!1);o.find(".palette-action-buttons").remove(),o.find(".boldgrid-active-palette").removeAttr("data-auto-generated"),a.clean_palette_clone(e.find(".boldgrid-active-palette")),a.revert_current_selection(o);var r=a.get_first_inactive();o.insertBefore(r)}else if(e.find(".boldgrid-inactive-palette").length){var l=e.clone(!1);a.clean_palette_clone(l.find(".boldgrid-inactive-palette")),e.after(l)}a.state=a.format_current_palette_state(),a.update_palette_settings()},a.clean_palette_clone=function(e){e.removeAttr("data-copy-on-mod data-palette-id")},a.get_first_inactive=function(){return o.$palette_control_wrapper.find('.boldgrid-color-palette-wrapper > [data-palette-wrapper="true"]').not(".current-palette-wrapper").first()},a.bind_compile_done=function(){t.on("boldgrid_sass_compile_done",function(e,t){a.doCompile(),"color_palette_focus"!==t.source&&a.update_iframe(t)})},a.update_iframe=function(e){a.compiled_css=e.result.text,a.update_palette_settings()},a.update_palette_settings=function(){a.text_area_val=JSON.stringify({state:a.state}),wp.customize("boldgrid_color_palette").set("").set(a.text_area_val)},a.get_random_format=function(){return a.body_classes[0]},a.wp_picker_post_init=function(){var t=o.$palette_control_wrapper.find('.boldgrid-inactive-palette[data-is-active="1"]'),a=o.$palette_control_wrapper.find('.boldgrid-inactive-palette[data-is-default="1"]'),r=a;t.length&&(r=t),r.click(),o.$palette_control_wrapper.find(".wp-color-result").addClass("expanded-wp-colorpicker"),e("body").on("click",function(){o.$palette_control_wrapper.find(".wp-color-result").addClass("expanded-wp-colorpicker"),o.$palette_control_wrapper.find(".boldgrid-color-palette-wrapper").find(".boldgrid-advanced-options").addClass("hidden"),o.$palette_control_wrapper.find(".active-palette-section").removeClass("active-palette-section")}),o.$palette_control_wrapper.find(".wp-color-result").on("click",function(){var t=e(this),a=t.parent().find(".iris-picker").is(":visible");a?(t.removeClass("expanded-wp-colorpicker"),o.$palette_control_wrapper.find(".active-palette-section").length||o.$palette_control_wrapper.find(".boldgrid-active-palette li:first").click()):(t.closest(".boldgrid-color-palette-wrapper").find(".boldgrid-advanced-options").addClass("hidden"),t.addClass("expanded-wp-colorpicker"))}),o.active_body_class=o.$palette_control_wrapper.find(".boldgrid-active-palette").first().attr("data-color-palette-format")},a.bindActiveColorClick=function(){o.$palette_control_wrapper.on("click",".boldgrid-active-palette li",function(r){var l,n,i,c,s=e(this),p=s.css("background-color"),d=!1,_=350,u=.4,f=.5;r.stopPropagation(),a.activate_color(null,e(this),!0),!o.fadeEffectInProgress&&r.originalEvent&&(i=a.get_previewer_body(),o.hasNeutral&&s.is(":last-of-type")&&(d=!0),n=net.brehaut.Color(p),n.getLuminance()>f?(l=n.darkenByAmount(u),l=l.toCSS()):(l=n.lightenByAmount(u),l=l.toCSS()),s.css("background-color",l),d&&s.closest(".boldgrid-active-palette").attr("data-neutral-color",l),i.addClass("color-palette-transitions"),a.update_theme_option(),s.css("background-color",p),d&&s.closest(".boldgrid-active-palette").attr("data-neutral-color",p),c=(new Date).getTime(),o.fadeEffectInProgress=!0,t.one("boldgrid_sass_compile_done",function(){var e=0,r=(new Date).getTime()-c;r<_&&(e=_),t.one("boldgrid_sass_compile_done",function(t,r){setTimeout(function(){a.update_iframe(r),setTimeout(function(){i.removeClass("color-palette-transitions"),o.fadeEffectInProgress=!1},250)},e)}),a.update_theme_option({source:"color_palette_focus"})}))})}}(jQuery);