var BOLDGRID=BOLDGRID||{};BOLDGRID.COLOR_PALETTE=BOLDGRID.COLOR_PALETTE||{},BOLDGRID.COLOR_PALETTE.Modify=BOLDGRID.COLOR_PALETTE.Modify||{},function(e){"use strict";var t=e(window),o=BOLDGRID.COLOR_PALETTE.Modify,a=o;colorPalette.compileQueue=[],colorPalette.palette_generator=BOLDGRID.COLOR_PALETTE.Generate,colorPalette.generated_color_palettes=6,colorPalette.state=null,colorPalette.active_body_class="",colorPalette.first_update=!0,colorPalette.prelockNeutral=!1,colorPalette.themePalettes=[];var l=["#232323","#FFFFFF","#FF5F5F","#FFDBB8","#FFFFB2","#bad6b1","#99acbf","#cdb5e2"];e(function(){a.$palette_control_wrapper=e("#customize-control-boldgrid-color-palette"),a.$color_picker_input=a.$palette_control_wrapper.find(".pluto-color-control"),a.$palette_option_field=a.$palette_control_wrapper.find(".palette-option-field"),a.generated_palettes_container=a.$palette_control_wrapper.find(".generated-palettes-container"),a.$accoridon_section_colors=e("#accordion-section-colors"),a.$paletteWrapper=a.$palette_control_wrapper.find(".boldgrid-color-palette-wrapper"),a.hasNeutral=a.$paletteWrapper.data("has-neutral"),a.numColors=a.$paletteWrapper.data("num-colors"),colorPalette.duplicate_modification_icons(),colorPalette.themePalettes=colorPalette.getThemePalettes(),colorPalette.bind_palette_duplicate_remove(),colorPalette.bind_palette_activation(),colorPalette.setup_color_picker(),colorPalette.setup_close_color_picker(),colorPalette.setup_palette_generation(),colorPalette.bind_generate_palette_action(),colorPalette.bind_help_section_visibility(),colorPalette.bind_help_link(),colorPalette.bindActiveColorClick(),colorPalette.setup_advanced_options(),colorPalette.bind_compile_done(),colorPalette.fetch_acceptable_palette_formats(),setTimeout(colorPalette.wp_picker_post_init,100)}),colorPalette.bind_help_section_visibility=function(){e(".accordion-section").on("click",function(){var t=e(".boldgrid-color-palette-help");a.$accoridon_section_colors.hasClass("open")&&!t.is(":visible")?t.show():!1===a.$accoridon_section_colors.hasClass("open")&&t.hide()})},colorPalette.get_previewer_body=function(){return e(wp.customize.previewer.container).find("iframe").last().contents().find("body")},colorPalette.bindActiveColorClick=function(){a.$palette_control_wrapper.on("click",".boldgrid-active-palette li",function(o){var l,r,c,i=e(this),n=i.css("background-color"),s=!1;if(o.stopPropagation(),colorPalette.activate_color(null,e(this),!0),!a.fadeEffectInProgress){c=colorPalette.get_previewer_body(),a.hasNeutral&&i.is(":last-of-type")&&(s=!0),r=net.brehaut.Color(n),r.getLuminance()>.5?(l="#3a3a3a",l=r.darkenByAmount(.4),l=l.toCSS()):(l="#FFF",l=r.lightenByAmount(.4),l=l.toCSS()),i.css("background-color",l),s&&i.closest(".boldgrid-active-palette").attr("data-neutral-color",l),colorPalette.state=colorPalette.format_current_palette_state(),i.css("background-color",n),s&&i.closest(".boldgrid-active-palette").attr("data-neutral-color",n),c.addClass("color-palette-transitions");var p=colorPalette.create_color_scss_file(colorPalette.state);BOLDGRID.Sass.compile(p+BOLDGRIDSass.ScssFormatFileContents);var d=(new Date).getTime(),_=350;a.fadeEffectInProgress=!0,t.one("boldgrid_sass_compile_done",function(){var e=0,o=(new Date).getTime(),l=o-d;_>l&&(e=_),t.one("boldgrid_sass_compile_done",function(t,o){setTimeout(function(){colorPalette.update_iframe(o),setTimeout(function(){c.removeClass("color-palette-transitions"),a.fadeEffectInProgress=!1},250)},e)}),colorPalette.state=colorPalette.format_current_palette_state();var r=colorPalette.create_color_scss_file(colorPalette.state);BOLDGRID.Sass.compile(r+BOLDGRIDSass.ScssFormatFileContents,{source:"color_palette_focus"})})}})},colorPalette.addColorTransition=function(){var e=600,t=colorPalette.get_previewer_body();t.addClass("color-palette-transitions duration-long");var o=(new Date).getTime();a.lastTransitionTime=o,setTimeout(function(){a.lastTransitionTime==o&&t.removeClass("color-palette-transitions duration-long")},e)},colorPalette.setup_close_color_picker=function(){a.$close_palette_creator=e("<button type='button' class='button close-color-picker'>Done</button>"),e(".boldgrid-color-palette-wrapper input[type=text].wp-color-picker").after(a.$close_palette_creator),a.$close_palette_creator.on("click",function(){e("body").click()})},colorPalette.getThemePalettes=function(){var t=[];return a.$palette_control_wrapper.find('.boldgrid-inactive-palette[data-copy-on-mod="1"]').each(function(){var o=[];e(this).find("[data-color]").each(function(){o.push(e(this).data("color"))}),a.hasNeutral&&o.splice(-1,1),t.push(o)}),t},colorPalette.setup_palette_generation=function(){a.$palette_control_wrapper.find(".palette-generator-button").on("click",function(e){!1===a.$paletteWrapper.hasClass("palette-generate-mode")&&(a.hasNeutral&&a.prelockNeutral&&(a.$palette_control_wrapper.find(".boldgrid-active-palette .boldgrid-palette-colors:last").addClass("selected-for-generation"),colorPalette.sync_locks()),a.$paletteWrapper.addClass("palette-generate-mode"))}),a.$palette_control_wrapper.on("click",".palette-generate-mode .current-palette-wrapper .color-lock",function(t){t.stopPropagation();var o=e(this);a.$palette_control_wrapper.find(".boldgrid-active-palette li").eq(o.data("count")).toggleClass("selected-for-generation"),o.toggleClass("selected-for-generation")}),a.$palette_control_wrapper.find(".cancel-generated-palettes-button").on("click",function(t){t.stopPropagation();var o=e(this);a.$palette_control_wrapper.find(".boldgrid-active-palette[data-auto-generated]").removeAttr("data-auto-generated"),a.generated_palettes_container.empty(),o.closest(".palette-generate-mode").removeClass("palette-generate-mode").find(".selected-for-generation").removeClass("selected-for-generation")})},colorPalette.duplicate_modification_icons=function(){colorPalette.$icon_set=a.$palette_control_wrapper.find(".boldgrid-duplicate-dashicons").first(),colorPalette.$icon_set&&(colorPalette.$icon_set=colorPalette.$icon_set.clone())},colorPalette.setup_advanced_options=function(){a.$palette_control_wrapper.find(".boldgrid-advanced-options-content").hide(),a.$palette_control_wrapper.find(".boldgrid-advanced-options").on("click",function(e){e.stopPropagation()}),a.$palette_control_wrapper.find(".boldgrid-advanced-options-label").on("click",function(t){t.stopPropagation(),e(this).closest(".boldgrid-advanced-options").find(".boldgrid-advanced-options-content").stop().slideToggle()})},colorPalette.bind_generate_palette_action=function(){a.$palette_control_wrapper.find(".palette-generator-button").on("click",function(t){var o=colorPalette.paletteData(),l=null;a.hasNeutral&&(o.samplePalette.splice(-1,1),l=o.partialPalette.splice(-1,1),l=l[0]);var r=BOLDGRID.COLOR_PALETTE.Generate.generate_palette_collection(o,colorPalette.generated_color_palettes);a.hasNeutral&&e.each(r,function(){l?this.push(l):this.push(colorPalette.palette_generator.generateNeutralColor(this))}),colorPalette.display_generated_palettes(r)})},colorPalette.display_generated_palettes=function(t){var o=a.generated_palettes_container.empty(),l=null;e.each(t,function(){a.hasNeutral&&(l=this[this.length-1]);var t=e('<div data-palette-wrapper="true"><ul><li class="boldgrid-palette-colors"></li></ul></div>'),r=t.find("ul").addClass("boldgrid-inactive-palette").attr("data-auto-generated","true").attr("data-neutral-color",l).attr("data-color-palette-format",colorPalette.get_random_format()),c=r.find("li");e.each(this,function(){var t=e("<span></span>").css("background-color",this).attr("data-color",!0);c.append(t)}),o.append(t)})},colorPalette.paletteData=function(){var t={samplePalette:[],partialPalette:[],additionalSamplePalattes:colorPalette.themePalettes};return a.$palette_control_wrapper.find(".boldgrid-active-palette .boldgrid-palette-colors").each(function(){var o=e(this);o.hasClass("selected-for-generation")?t.partialPalette.push(o.css("background-color")):t.partialPalette.push(null),t.samplePalette.push(o.css("background-color"))}),t},colorPalette.fetch_acceptable_palette_formats=function(){colorPalette.body_classes=a.$palette_control_wrapper.find(".boldgrid-color-palette-wrapper").data("color-formats"),"object"==typeof colorPalette.body_classes&&(colorPalette.body_classes=e.map(colorPalette.body_classes,function(e,t){return[e]}))},colorPalette.revert_current_selection=function(t){t.removeClass("current-palette-wrapper");var o=t.find("> ul");o.removeClass("boldgrid-active-palette").addClass("boldgrid-inactive-palette"),o.find(".boldgrid-duplicate-dashicons").remove();var a=e('<li class="boldgrid-palette-colors"></li>');o.find(".boldgrid-palette-colors:not(.ui-sortable-helper)").not(".ui-sortable-placeholder").each(function(){var t=e(this);if("absolute"!=t.css("position")){var o=e('<span data-color="true"></span>').css("background-color",t.css("background-color"));a.append(o)}}),t.find(".bg-lock-controls").remove(),a.append(colorPalette.$icon_set.clone()),o.find(".boldgrid-palette-colors").remove(),o.append(a),o.data("ui-sortable")&&o.sortable("disable")},colorPalette.bind_help_link=function(){a.$palette_control_wrapper.on("click",'[data-action="open-color-picker"]',function(e){e.stopPropagation();var t=a.$palette_control_wrapper.find(".boldgrid-active-palette .boldgrid-palette-colors:first");colorPalette.activate_color(null,t)})},colorPalette.sync_locks=function(){var t=a.$palette_control_wrapper.find(".bg-lock-controls .color-lock");t.removeClass("selected-for-generation"),a.$palette_control_wrapper.find(".boldgrid-active-palette .boldgrid-palette-colors").each(function(o){var a=e(this);a.hasClass("selected-for-generation")&&t.eq(o).addClass("selected-for-generation")})},colorPalette.activate_palette=function(t){colorPalette.addColorTransition(),a.$palette_control_wrapper.find(".wp-color-result").addClass("expanded-wp-colorpicker"),t.attr("data-auto-generated")&&(t=t.closest("div").clone().find("[data-auto-generated]"));var o=[];a.$palette_control_wrapper.find(".boldgrid-active-palette .boldgrid-palette-colors").each(function(t){var a=e(this);a.hasClass("selected-for-generation")&&o.push(t)}),t.find("span[data-color]").each(function(a){var l=e(this),r=l.css("background-color"),c="";"-1"!=o.indexOf(a)&&(c="selected-for-generation"),t.append('<li class="boldgrid-palette-colors '+c+' boldgrid-dashicon" style="background-color: '+r+'"></li>')}),t.append(colorPalette.$icon_set.clone()),t.find("li:first").remove();var l=t.closest("div").addClass("current-palette-wrapper").detach();a.$palette_control_wrapper.find(".boldgrid-color-palette-wrapper").prepend(l);var r=a.$palette_control_wrapper.find(".palette-action-buttons");r.removeClass("hidden").insertAfter(t),colorPalette.$color_picker.show(),a.$palette_control_wrapper.find(".boldgrid-active-palette").each(function(){var t=e(this);t.attr("data-auto-generated")?t.closest("div").remove():colorPalette.revert_current_selection(t.closest("div"))}),colorPalette.add_jquery_sortable(t),t.sortable("enable"),t.disableSelection(),t.removeClass("boldgrid-inactive-palette"),t.addClass("boldgrid-active-palette"),t.find("li").disableSelection();var c=e('<div class="bg-lock-controls"></div>');t.find("li").each(function(e){c.append('<div class="color-lock" data-count="'+e+'"><div class="lock unlock"><div class="top"></div><div class="mid"></div><div class="bottom"><div class="keyhole-top"></div><div class="keyhole-bottom"></div></div></div>')}),t.after(c),colorPalette.sync_locks(),colorPalette.first_update?colorPalette.first_update=!1:colorPalette.update_theme_option()},colorPalette.add_jquery_sortable=function(t){var o=[],l=null;t.sortable({items:".boldgrid-palette-colors",axis:"x",start:function(r,c){o=[],l=null,c.item&&(a.$palette_control_wrapper.find(".active-palette-section").removeClass("active-palette-section"),c.item.find("span").length||colorPalette.modify_palette_action(c.item.closest('[data-palette-wrapper="true"]')),c.placeholder.css("background-color",c.item.css("background-color")).css("visibility","visible"),t.find("li").not(c.helper).not(c.placeholder).each(function(t){var a=e(this);o.push(a.css("background-color")),a.is(c.item)&&(l=t)}))},change:function(a,r){var c=t.find("li").not(r.helper).not(r.item);c.each(function(t){var a=e(this),i=o[t];a.is(r.placeholder)?c.eq(l).css("background-color",i):l!==t&&c.eq(t).css("background-color",i)})},helper:"clone",stop:function(t,o){if(colorPalette.addColorTransition(),colorPalette.update_theme_option(),colorPalette.open_picker(),o.item){var l=o.item;if(!l.find("span").length){a.$palette_control_wrapper.find(".active-palette-section").removeClass("active-palette-section"),l.addClass("active-palette-section"),l.siblings().each(function(){var t=e(this);t.toggleClass("boldgrid-dashicon"),setTimeout(function(){t.toggleClass("boldgrid-dashicon")},15)});var r=l.closest(".boldgrid-color-palette-wrapper");colorPalette.preselect_active_color(r),colorPalette.sync_locks(),colorPalette.updateNeutralData()}}}})},colorPalette.format_current_palette_state=function(){var t=a.$palette_control_wrapper.find(".boldgrid-active-palette").first(),o={};o["active-palette"]=t.attr("data-color-palette-format"),o["active-palette-id"]=t.attr("data-palette-id"),o.palettes={},o.saved_palettes=[],a.active_body_class=o["active-palette"];var l=function(){var t=e(this),l={};l=t.hasClass("boldgrid-active-palette")?t.find("li.boldgrid-palette-colors"):t.find(".boldgrid-palette-colors > span");var r=[];l.not(a.hasNeutral?":last-of-type":"").each(function(){r.push(e(this).css("background-color"))});var c={format:t.attr("data-color-palette-format"),colors:r,"neutral-color":t.attr("data-neutral-color")};o.palettes[t.attr("data-color-palette-format")]=c,t.attr("data-copy-on-mod")||o.saved_palettes.push(c)};return a.$palette_control_wrapper.find("[data-color-palette-format]").not(t).not('[data-auto-generated="true"]').each(l),t.each(l),o},colorPalette.create_color_scss_file=function(t){var o="";o+="$palette-primary_1: null;$palette-primary_2: null;$palette-primary_3: null;$palette-primary_4: null;$palette-primary_5: null;$palette-primary-neutral-color: null;$text-contrast-palette-primary-1: null;$text-contrast-palette-primary-2: null;$text-contrast-palette-primary-3: null;$text-contrast-palette-primary-4: null;$text-contrast-palette-primary-5: null;$text-contrast-palette-primary-neutral-color: null;";var a="$colors: ";e.each(t.palettes,function(t){if(this.colors){var l=a;e.each(this.colors,function(e){var a=e+1;o+="$"+t+"_"+a.toString()+":"+this+";",l+="$"+t+"_"+a.toString()+" "}),l!=a&&(o+=l+";")}this["neutral-color"]&&(o+="$"+t+"-neutral-color:"+this["neutral-color"]+";")});var l=wp.customize("boldgrid_light_text").get(),r=wp.customize("boldgrid_dark_text").get();return o+="$light-text:"+l+";",o+="$dark-text:"+r+";"},colorPalette.update_theme_option=function(){colorPalette.state=colorPalette.format_current_palette_state();var e=colorPalette.create_color_scss_file(colorPalette.state);BOLDGRID.Sass.compile(e+BOLDGRIDSass.ScssFormatFileContents)},colorPalette.compile=function(e){colorPalette.compileQueue.push(e),colorPalette.doCompile();colorPalette.compileQueue[colorPalette.compileQueue.length-1];BOLDGRID.Sass.compile(e.contents,e.send)},colorPalette.do_compile=function(){},colorPalette.bind_palette_activation=function(){a.$palette_control_wrapper.on("click",".boldgrid-inactive-palette",function(){colorPalette.activate_palette(e(this))})},colorPalette.activate_color=function(t,o,r){var c;t?(c=e(this),t.stopPropagation()):c=o,!1===c.hasClass("active-palette-section")&&(a.hasNeutral&&c.is(".boldgrid-active-palette .boldgrid-palette-colors:last")?a.$color_picker_input.iris({palettes:l}):a.$color_picker_input.iris({palettes:!0}),colorPalette.modify_palette_action(c.closest('[data-palette-wrapper="true"]')),a.$palette_control_wrapper.find(".active-palette-section").removeClass("active-palette-section"),c.addClass("active-palette-section"),colorPalette.open_picker(),r&&a.pause_color_changes(),colorPalette.set_iris_color(c.css("background-color")))},colorPalette.pause_color_changes=function(){a.ignoreColorChange=!0,setTimeout(function(){a.ignoreColorChange=!1},100)},colorPalette.open_picker=function(){a.$palette_control_wrapper.find(".wp-picker-open").length||a.$palette_control_wrapper.find(".wp-color-result").click()},colorPalette.set_iris_color=function(e){var t=net.brehaut.Color(e);a.$color_picker_input.iris("color",t.toString())},colorPalette.updateNeutralData=function(){var e,t,o;e=!!a.$palette_control_wrapper.find(".boldgrid-active-palette").attr("data-neutral-color"),e&&(o=a.$palette_control_wrapper.find(".boldgrid-active-palette"),t=o.find(".boldgrid-palette-colors:last").css("background-color"),o.attr("data-neutral-color",t))},colorPalette.setup_color_picker=function(){var e={defaultColor:!1,change:function(e,t){var o=t.color.toString();if(a.$palette_control_wrapper.find(".active-palette-section").css("background-color",o),colorPalette.updateNeutralData(),colorPalette.updateCustomPalettes(),!a.ignoreColorChange){colorPalette.last_refresh_time=(new Date).getTime();var l=colorPalette.last_refresh_time;setTimeout(function(){!BOLDGRID.Sass.processing&&(l==colorPalette.last_refresh_time||a.most_recent_update+100<(new Date).getTime())&&(colorPalette.update_theme_option(),a.most_recent_update=(new Date).getTime())},200,l)}},hide:!0,palettes:!0};a.$color_picker_input.wpColorPicker(e),colorPalette.$color_picker=a.$palette_control_wrapper.find(".wp-picker-container").hide(),colorPalette.createPickerPalettes(),colorPalette.bindCustomPalettes()},colorPalette.updateCustomPalettes=function(t,o){var l=a.$palette_control_wrapper.find(".secondary-colors .iris-palette");t&&o?l.eq(t).css("background-color",o):a.$palette_control_wrapper.find(".boldgrid-active-palette .boldgrid-palette-colors").each(function(t){l.eq(t).css("background-color",e(this).css("background-color"))})},colorPalette.createPickerPalettes=function(){for(var t=e('<div class="secondary-colors"></div>'),o=0;o<a.numColors;o++)t.append('<a class="iris-palette" tabindex="0"></a>');t.prependTo(a.$palette_control_wrapper.find(".iris-picker-inner"))},colorPalette.bindCustomPalettes=function(){a.$palette_control_wrapper.find(".secondary-colors .iris-palette").on("click",function(){colorPalette.set_iris_color(e(this).css("background-color"))})},colorPalette.preselect_active_color=function(e){colorPalette.set_iris_color(e.find(".active-palette-section").css("background-color"))},colorPalette.bind_palette_duplicate_remove=function(){a.$palette_control_wrapper.on("click",".boldgrid-copy-palette, .boldgrid-remove-palette",function(t){t.stopPropagation();var o=e(this),a=o.closest('[data-palette-wrapper="true"]'),l=!0;o.hasClass("boldgrid-copy-palette")&&(l=!1),l?colorPalette.remove_palette(a):colorPalette.copy_palette(a)})},colorPalette.remove_palette=function(e){e.find(".boldgrid-inactive-palette").length&&(e.remove(),colorPalette.state=colorPalette.format_current_palette_state(),colorPalette.update_palette_settings(!0))},colorPalette.modify_palette_action=function(e){e.find('[data-copy-on-mod="1"]').length&&colorPalette.copy_palette(e)},colorPalette.copy_palette=function(e){var t=e.find(".boldgrid-active-palette");if(t.length){var o=e.clone(!1);o.find(".palette-action-buttons").remove(),o.find(".boldgrid-active-palette").removeAttr("data-auto-generated"),colorPalette.clean_palette_clone(e.find(".boldgrid-active-palette")),colorPalette.revert_current_selection(o);var a=colorPalette.get_first_inactive();o.insertBefore(a)}else if(e.find(".boldgrid-inactive-palette").length){var l=e.clone(!1);colorPalette.clean_palette_clone(l.find(".boldgrid-inactive-palette")),e.after(l)}colorPalette.state=colorPalette.format_current_palette_state(),colorPalette.update_palette_settings(!0)},colorPalette.clean_palette_clone=function(e){e.removeAttr("data-copy-on-mod").removeAttr("data-palette-id")},colorPalette.get_first_inactive=function(){return a.$palette_control_wrapper.find('.boldgrid-color-palette-wrapper > [data-palette-wrapper="true"]').not(".current-palette-wrapper").first()},colorPalette.bind_compile_done=function(){t.on("boldgrid_sass_compile_done",function(e,t){"color_palette_focus"!==t.source&&colorPalette.update_iframe(t)})},colorPalette.update_iframe=function(e){colorPalette.compiled_css=e.result.text,colorPalette.update_palette_settings(!0)},colorPalette.update_palette_settings=function(e){colorPalette.text_area_val=JSON.stringify({state:colorPalette.state}),a.$palette_option_field.val(colorPalette.text_area_val),e&&a.$palette_option_field.change()},colorPalette.get_random_format=function(){return colorPalette.body_classes[0]},colorPalette.wp_picker_post_init=function(){var t=a.$palette_control_wrapper.find('.boldgrid-inactive-palette[data-is-active="1"]'),o=a.$palette_control_wrapper.find('.boldgrid-inactive-palette[data-is-default="1"]'),l=o;t.length&&(l=t),l.click(),a.$palette_control_wrapper.find(".wp-color-result").addClass("expanded-wp-colorpicker"),e("body").on("click",function(){a.$palette_control_wrapper.find(".wp-color-result").addClass("expanded-wp-colorpicker"),a.$palette_control_wrapper.find(".boldgrid-color-palette-wrapper").find(".boldgrid-advanced-options").addClass("hidden"),a.$palette_control_wrapper.find(".active-palette-section").removeClass("active-palette-section")}),a.$palette_control_wrapper.find(".wp-color-result").on("click",function(){var t=e(this),o=t.parent().find(".iris-picker").is(":visible");if(o){t.closest(".boldgrid-color-palette-wrapper");t.removeClass("expanded-wp-colorpicker"),a.$palette_control_wrapper.find(".active-palette-section").length||a.$palette_control_wrapper.find(".boldgrid-active-palette li:first").click()}else t.closest(".boldgrid-color-palette-wrapper").find(".boldgrid-advanced-options").addClass("hidden"),t.addClass("expanded-wp-colorpicker")}),a.active_body_class=a.$palette_control_wrapper.find(".boldgrid-active-palette").first().attr("data-color-palette-format")}}(jQuery);