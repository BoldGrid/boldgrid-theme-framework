var BOLDGRID=BOLDGRID||{};BOLDGRID.Customizer=BOLDGRID.Customizer||{},BOLDGRID.Customizer.Util=BOLDGRID.Customizer.Util||{},BOLDGRID.Customizer.Util.bgtfwIsJSON=function(t){return!(!_.isString(t)||/^\s*$/.test(t))&&(t=t.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@"),t=t.replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]"),t=t.replace(/(?:^|:|,)(?:\s*\[)+/g,""),/^[\],:{}\s]*$/.test(t))},BOLDGRID.Customizer.Util.bgtfwParseJSON=function(t){if(BOLDGRID.Customizer.Util.bgtfwIsJSON(t))try{var e=JSON.parse(t);if(e&&_.isObject(e))return e}catch(i){return!1}return!1},BOLDGRID.Customizer.Util.getInitialPalettes=function(t){var e,i,o;return _.isUndefined(t)&&(t=wp.customize("boldgrid_color_palette")()),e=BOLDGRID.Customizer.Util.bgtfwParseJSON(t),!(!e||_.isUndefined(e.state)||_.isUndefined(e.state.palettes)||_.isUndefined(e.state["active-palette"])||(o=e.state["active-palette"],_.isUndefined(e.state.palettes[o])||(o=e.state.palettes[o],_.isUndefined(o.colors)||(i=o.colors,_.isUndefined(o["neutral-color"])||i.push(o["neutral-color"]),!i.length))))&&i},function(t){var e,i,o;e=t("body"),i=t("#boldgrid-override-styles"),t(function(){g(),b(),n(),t(".site-description").addClass(_typographyClasses),t(document).on("customize-preview-menu-refreshed",function(t,e){_.isUndefined(BoldGrid)||(console.log(e),"main"===e.wpNavMenuArgs.theme_location&&(_.isUndefined(BoldGrid.standard_menu_enabled)||BoldGrid.standard_menu_enabled.init(e.newContainer)))}),o=BOLDGRID.Customizer.Util.getInitialPalettes(),o&&!_.isUndefined(parent.$.wp)&&(parent.$.wp.wpColorPicker.prototype.options={palettes:o});var e=t(".customize-control-kirki-color .iris-palette-container");_(e).each(function(e){var i,o,n;o=t(e).parent(".iris-picker"),o.css("padding-bottom",0),o.find(".iris-slider").css("height","100%"),i=t(e).find(".iris-palette"),n=t(e).closest(".customize-control-kirki-color"),t(e).appendTo(n),t(i).on("click",function(e){t(i).removeClass("iris-active-palette"),t(e.currentTarget).addClass("iris-active-palette")})})}),wp.customize("blogname",function(e){parent.wp.customize("boldgrid_logo_setting")&&!parent.wp.customize("boldgrid_logo_setting").get()&&e.bind(function(e){t(".site-title a").text(e)})}),wp.customize("blogdescription",function(e){e.bind(function(e){e?t(".site-description").text(e).removeClass("invisible"):t(".site-description").text("").addClass("invisible")})}),wp.customize("bgtfw_header_layout_position",function(e){e.bind(function(e){t("body").removeClass("header-top header-left header-right").addClass(e)})}),wp.customize("bgtfw_fixed_header",function(e){e.bind(function(e){var i=t("body");e?i.addClass("header-fixed"):i.removeClass("header-fixed")})}),wp.customize("bgtfw_header_top_layouts",function(e){e.bind(function(e){t("#masthead").removeClass(function(t,e){return(e.match(/(^|\s)layout-\S+/g)||[]).join(" ")}).addClass(e)})}),wp.customize("boldgrid_color_palette",function(e){e.bind(function(e){var i,o;i=parent.$(".customize-control-kirki-color").find(".wp-picker-container"),o=BOLDGRID.Customizer.Util.getInitialPalettes(e),parent.$.wp.wpColorPicker.prototype.options={palettes:o},_(i).each(function(e){var i=t(e).find(".iris-palette");_(i).each(function(e,i){t(e).css("background-color",o[i])})})})}),wp.customize("custom_theme_css",function(e){e.bind(function(e){t("#boldgrid-custom-css").html(e)})}),wp.customize("boldgrid_background_vertical_position",function(t){t.bind(c)}),wp.customize("boldgrid_background_horizontal_position",function(t){t.bind(d)}),wp.customize("boldgrid_background_pattern",function(t){t.bind(u)}),wp.customize("boldgrid_background_color",function(t){t.bind(u)}),wp.customize("boldgrid_background_type",function(t){t.bind(a)}),wp.customize("background_attachment",function(t){t.bind(s)}),wp.customize("background_image",function(t){t.bind(l)}),wp.customize("background_repeat",function(t){t.bind(p)}),wp.customize("boldgrid_background_image_size",function(t){t.bind(r)});var n=function(){t(".post-edit-link").on("click",function(){parent.location=t(this).attr("href")})},a=function(t){"pattern"===t?u():(e.css({"background-image":"","background-size":"","background-repeat":"","background-attachment":""}),g()),i.remove()},r=function(t){e.css("background-size",t)},s=function(i){if("parallax"===i)e.addClass("boldgrid-customizer-parallax-effect"),e.css("background-attachment","fixed"),e.css({"background-position":"0px 0px","background-attachment":"fixed"}),e.data("stellar-background-ratio","0.2"),e.stellar(),e.data("plugin_stellar")&&e.data("plugin_stellar").init();else{var o=t("body").data("plugin_stellar");o&&o.destroy(),r(wp.customize("boldgrid_background_image_size")()),e.css({"background-attachment":i}),c(),d(),p(),e.removeClass("boldgrid-customizer-parallax-effect")}},c=function(){var t=wp.customize("boldgrid_background_vertical_position")(),i=e.css("background-position"),o=i.split(" ")[0]+" "+5*t+"px";e.css("background-position",o)},d=function(){var t=wp.customize("boldgrid_background_horizontal_position")(),i=e.css("background-position"),o=5*t+"px "+i.split(" ")[1];e.css("background-position",o)},u=function(){var t=wp.customize("boldgrid_background_color")(),o=wp.customize("boldgrid_background_pattern")();t&&"none"!==t||(t=""),o||(o="none"),i.remove(),e.css({"background-image":o,"background-size":"auto","background-repeat":"repeat","background-attachment":"scroll","background-color":t})},l=function(t){t=t?"url("+t+")":"",e.css({"background-image":t})},p=function(){e.css({"background-repeat":wp.customize("background_repeat")()})},g=function(){t("#custom-background-css").remove();var e=wp.customize("background_attachment")(),i=wp.customize("boldgrid_background_image_size")(),o=wp.customize("boldgrid_background_type")();if(u(),"pattern"!==o){s(e),r(i);var n=wp.customize("background_image")();l(n),"parallax"!==e&&(c(),d(),p())}},b=function(){var e;wp.customize.bind("ready",_.defer(function(){_.isFunction(parent.wp.customize.section)&&(e=parent.wp.customize.section("boldgrid_footer_panel").controls(),_(e).each(function(e){var i,o=new RegExp(/^(hide_)+\w*(_attribution)+$/,"m");o.test(e.id)&&parseInt(wp.customize(e.id)())&&(i="."+e.id.replace("hide_","").replace(/_/g,"-")+"-link",t(i).addClass("hidden"))})),m()}))},m=function(){t(".attribution-theme-mods > .link").removeClass("no-separator").filter(":visible").last().addClass("no-separator")};if(_.isFunction(parent.wp.customize.section)){var f=parent.wp.customize.section("boldgrid_footer_panel").controls();_(f).each(function(e){var i,o=new RegExp(/^(hide_)+\w*(_attribution)+$/,"m");o.test(e.id)&&wp.customize(e.id,function(o){i="."+e.id.replace(/hide_/,"").replace(/_/g,"-")+"-link",o.bind(function(e){e?t(i).addClass("hidden"):t(i).removeClass("hidden"),m()})})})}}(jQuery);