var BOLDGRID=BOLDGRID||{};BOLDGRID.Customizer=BOLDGRID.Customizer||{},BOLDGRID.Customizer.Util=BOLDGRID.Customizer.Util||{},BOLDGRID.Customizer.Util.bgtfwIsJSON=function(t){return!(!_.isString(t)||/^\s*$/.test(t))&&(t=t.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@"),t=t.replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]"),t=t.replace(/(?:^|:|,)(?:\s*\[)+/g,""),/^[\],:{}\s]*$/.test(t))},BOLDGRID.Customizer.Util.bgtfwParseJSON=function(t){if(BOLDGRID.Customizer.Util.bgtfwIsJSON(t))try{var e=JSON.parse(t);if(e&&_.isObject(e))return e}catch(i){return!1}return!1},BOLDGRID.Customizer.Util.getInitialPalettes=function(t){var e,i,n;return _.isUndefined(t)&&(t=wp.customize("boldgrid_color_palette")()),e=BOLDGRID.Customizer.Util.bgtfwParseJSON(t),!(!e||_.isUndefined(e.state)||_.isUndefined(e.state.palettes)||_.isUndefined(e.state["active-palette"])||(n=e.state["active-palette"],_.isUndefined(e.state.palettes[n])||(n=e.state.palettes[n],_.isUndefined(n.colors)||(i=n.colors,_.isUndefined(n["neutral-color"])||i.push(n["neutral-color"]),!i.length))))&&i},function(t){var e,i;e=t("body"),i=t("#boldgrid-override-styles"),t(function(){b(),m(),o(),t(".site-description").addClass(_typographyClasses),t(document).on("customize-preview-menu-refreshed",function(t,e){_.isUndefined(BoldGrid)||"main"===e.wpNavMenuArgs.theme_location&&(_.isUndefined(BoldGrid.standard_menu_enabled)||BoldGrid.standard_menu_enabled.init(e.newContainer))})}),wp.customize("blogname",function(e){parent.wp.customize("boldgrid_logo_setting")&&!parent.wp.customize("boldgrid_logo_setting").get()&&e.bind(function(e){t(".site-title a").text(e)})}),t.each(["external_header_video","header_video"],function(t,e){wp.customize(e,function(t){t.bind(function(){wp.customize.preview.send("url",window.location.href)})})}),t.each(["bgtfw_site_title_typography","bgtfw_tagline_typography"],function(e,i){wp.customize(i,function(e){e.bind(function(i){t.each(["font-size","line-height","font-family","font-weight"],function(t,o){e[o]!==i[o]&&n()})})})}),wp.customize("blogdescription",function(e){e.bind(function(e){e?t(".site-description").text(e).removeClass("invisible"):t(".site-description").text("").addClass("invisible")})});var n=function(){wp.customize("bgtfw_fixed_header")?BoldGrid.header_fixed.calc():BoldGrid.custom_header.calc(),t(window).trigger("resize")};wp.customize("bgtfw_header_layout_position",function(e){e.bind(function(e){var i;t("body").removeClass("header-top header-left header-right").addClass(e),"header-left"!==e&&"header-right"!==e||(i=wp.customize("bgtfw_header_width")(),parent.kirkiSetSettingValue.set("bgtfw_header_width",i)),n()})}),wp.customize("bgtfw_fixed_header",function(e){e.bind(function(e){var i=t("body");e?i.addClass("header-fixed"):i.removeClass("header-fixed"),n()})}),wp.customize("bgtfw_header_top_layouts",function(e){e.bind(function(e){t("#masthead").removeClass(function(t,e){return(e.match(/(^|\s)layout-\S+/g)||[]).join(" ")}).addClass(e),n()})}),wp.customize("bgtfw_header_width",function(t){t.bind(function(){n()})}),wp.customize("bgtfw_footer_layouts",function(e){e.bind(function(e){t("#colophon").removeClass(function(t,e){return(e.match(/(^|\s)layout-\S+/g)||[]).join(" ")}).addClass(e)})}),wp.customize("boldgrid_color_palette",function(e){e.bind(function(e){var i,n;i=parent.$(".colors-wrapper"),n=BOLDGRID.Customizer.Util.getInitialPalettes(e),n&&_(i).each(function(e){var i=t(e).find("input");_(i).each(function(e,i){var o,a,r;o=t(e).val(),a=o.substring(0,o.indexOf(":")+1)+n[i],t(e).val(a),t(e).next().find(".color-palette-color").css("background",n[i]).text(n[i]),t(e).is(":checked")&&(r=t(e).data("customize-setting-link"),_.isUndefined(r)||parent.wp.customize(r).set(a))})})})}),wp.customize("custom_theme_css",function(e){e.bind(function(e){t("#boldgrid-custom-css").html(e)})}),wp.customize("boldgrid_background_vertical_position",function(t){t.bind(s)}),wp.customize("boldgrid_background_horizontal_position",function(t){t.bind(d)}),wp.customize("boldgrid_background_pattern",function(t){t.bind(f)}),wp.customize("boldgrid_background_color",function(t){t.bind(f)}),wp.customize("bgtfw_header_color",function(t){t.bind(function(){l("bgtfw_header_color","#masthead")})}),wp.customize("bgtfw_header_headings_color",function(t){t.bind(function(t){u(t,".site-header")})}),wp.customize("bgtfw_footer_headings_color",function(t){t.bind(function(t){u(t,".site-footer")})}),wp.customize("bgtfw_footer_color",function(t){t.bind(function(){l("bgtfw_footer_color","#colophon")})}),wp.customize("boldgrid_background_type",function(t){t.bind(a)}),wp.customize("background_attachment",function(t){t.bind(c)}),wp.customize("background_image",function(t){t.bind(p)}),wp.customize("background_repeat",function(t){t.bind(g)}),wp.customize("boldgrid_background_image_size",function(t){t.bind(r)});var o=function(){t(".post-edit-link").on("click",function(){parent.location=t(this).attr("href")})},a=function(t){"pattern"===t?f():(e.css({"background-image":"","background-size":"","background-repeat":"","background-attachment":""}),b()),i.remove()},r=function(t){e.css("background-size",t)},c=function(i){if("parallax"===i)e.addClass("boldgrid-customizer-parallax-effect"),e.css("background-attachment","fixed"),e.css({"background-position":"0px 0px","background-attachment":"fixed"}),e.data("stellar-background-ratio","0.2"),e.stellar(),e.data("plugin_stellar")&&e.data("plugin_stellar").init();else{var n=t("body").data("plugin_stellar");n&&n.destroy(),r(wp.customize("boldgrid_background_image_size")()),e.css({"background-attachment":i}),s(),d(),g(),e.removeClass("boldgrid-customizer-parallax-effect")}},s=function(){var t=wp.customize("boldgrid_background_vertical_position")(),i=e.css("background-position"),n=i.split(" ")[0]+" "+5*t+"px";e.css("background-position",n)},d=function(){var t=wp.customize("boldgrid_background_horizontal_position")(),i=e.css("background-position"),n=5*t+"px "+i.split(" ")[1];e.css("background-position",n)},u=function(e,i){var n;e&&"none"!==e&&(n=e.split(":").pop(),t(i).find("h1,h2,h3,h4,h5,h6,.h1,.h2,.h3,.h4,.h5,.h6").css("color",n))},l=function(e,i){var n;e=parent.wp.customize(e)(),e&&"none"!==e||(e=""),n=e.split(":").shift(),t(i).removeClass(function(t,e){return(e.match(/(^|\s)color-?([\d]|neutral)\-(background|text)\S+/g)||[]).join(" ")}),~n.indexOf("neutral")||(n=n.replace("-","")),t(i).addClass(n+"-background-color "+n+"-text-default")},f=function(){var t;t=wp.customize("boldgrid_background_pattern")(),t||(t="none"),i.remove(),e.css({"background-image":t,"background-size":"auto","background-repeat":"repeat","background-attachment":"scroll"}),l("boldgrid_background_color","body")},p=function(t){t=t?"url("+t+")":"",e.css({"background-image":t})},g=function(){e.css({"background-repeat":wp.customize("background_repeat")()})},b=function(){t("#custom-background-css").remove();var e=wp.customize("background_attachment")(),i=wp.customize("boldgrid_background_image_size")(),n=wp.customize("boldgrid_background_type")();if(f(),"pattern"!==n){c(e),r(i);var o=wp.customize("background_image")();p(o),"parallax"!==e&&(s(),d(),g())}},m=function(){var e;wp.customize.bind("ready",_.defer(function(){_.isFunction(parent.wp.customize.section)&&(e=parent.wp.customize.section("boldgrid_footer_panel").controls(),_(e).each(function(e){var i,n=new RegExp(/^(hide_)+\w*(_attribution)+$/,"m");n.test(e.id)&&parseInt(wp.customize(e.id)())&&(i="."+e.id.replace("hide_","").replace(/_/g,"-")+"-link",t(i).addClass("hidden"))})),h()}))},h=function(){t(".attribution-theme-mods > .link").removeClass("no-separator").filter(":visible").last().addClass("no-separator")};if(_.isFunction(parent.wp.customize.section)){var w=parent.wp.customize.section("boldgrid_footer_panel").controls();_(w).each(function(e){var i,n=new RegExp(/^(hide_)+\w*(_attribution)+$/,"m");n.test(e.id)&&wp.customize(e.id,function(n){i="."+e.id.replace(/hide_/,"").replace(/_/g,"-")+"-link",n.bind(function(e){e?t(i).addClass("hidden"):t(i).removeClass("hidden"),h()})})})}}(jQuery);