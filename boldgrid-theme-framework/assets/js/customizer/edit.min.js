var BOLDGRID=BOLDGRID||{};BOLDGRID.Customizer_Edit=function(t){var o=this,n=parent.wp.customize;t(function(){setTimeout(o.init,500)}),this.addButtons=function(){var e={blogname:".site-title a",boldgrid_logo_size:".logo-site-title",boldgrid_enable_footer:".attribution","entry-content":".entry-content","entry-title":".entry-title",blogdescription:".site-description"},i=_.keys(e);_(i).each(function(t){o.addButton(null,t,e[t])}),t("aside.widget").each(function(){var n=t(this),e=n.attr("id");o.addButton("sidebar",e,"#"+e)}),t('aside[id^="black-studio-tinymce-"').each(function(){var n,e=t(this);n=e.attr("id").replace("black-studio-tinymce-","").trim(),o.addButton("widget_black-studio-tinymce",n,"#"+e.attr("id"))});var s;e=n.section("menu_locations").controls(),_(e).each(function(n){s=t("."+n.themeLocation.replace(/_/g,"-")+"-menu").find("ul").first().attr("id"),o.addButton("nav_menu",n.setting._value,"#"+s)})},this.bindEdit=function(){t("[data-control]").on("click",function(){var o=t(this).attr("data-control"),e=parent.window._wpCustomizeControlsL10n.cancel,i={width:400,resizable:!1,modal:!0},s=boldgridFrameworkCustomizerEdit.goThereNow;if(i.buttons={},i.buttons[s]=function(){parent.window.location=boldgridFrameworkCustomizerEdit.editPostLink},i.buttons[e]=function(){t(this).dialog("close")},"entry-content"==o||"entry-title"==o)return void t("#"+o).dialog(i);if(0===o.lastIndexOf("sidebar",0)){var a=o.match(/\[(.*?)\]/);n.Widgets.focusWidgetFormControl(a[1])}else n.control(o).focus();setTimeout(function(){var e=t(":focus",parent.document);"boldgrid_enable_footer"===o&&(e=t(n.control(o).selector,parent.document)),0===o.lastIndexOf("nav_menu",0)&&(e=t(".customize-control-nav_menu_name",parent.document)),e.css({"min-height":e.outerHeight(),"min-width":e.outerWidth()}).effect("bounce",{times:3,distance:10},"slow")},500)})},this.buttonHover=function(n,e,i){var s,a=e.offset(),r=t("#target-highlight"),c=e.outerHeight();s=i.offset(),0===c&&e.find("*").each(function(){var o=t(this),n=o.outerHeight();n>c&&(c=n)}),n.hover(function(){r.css("width",i.outerWidth()).css("height",c).css("top",a.top).css("left",s.left)},function(){r.css("width","0px").css("height","0px")}),e.hover(function(){n.addClass("highlight-button"),o.windowScroll()},function(){n.removeClass("highlight-button")})},this.fadeOut=function(){t("[data-control]").css("opacity","1").animate({opacity:.5},2e3,function(){t("[data-control]").css("opacity","")})},this.fixButtonPlacement=function(){var n='[data-control][style*="position: fixed"]:not(.highlight-button)';t(n).each(function(){var n=t(this),e=t(n.attr("data-selector"));o.topInView(e)&&(n.css("position","absolute").css("top",t(window).scrollTop()),o.placeButtons("[data-control="+n.attr("data-control")+"]"))})},this.init=function(){o.addButtons(),o.placeButtons(),o.bindEdit(),o.fadeOut(),t(window).resize(function(){clearTimeout(t.data(this,"resizeTimer")),t.data(this,"resizeTimer",setTimeout(function(){o.placeButtons()},400))}),t(".navbar-toggle").click(function(){setTimeout(o.placeButtons,400)}),t(window).scroll(function(){clearTimeout(t.data(this,"scrollTimer")),t.data(this,"scrollTimer",setTimeout(function(){o.windowScroll(),o.fixButtonPlacement()},100))})},this.parentColumn=function(t){return $parentsContainer=t.closest("div[class*=col-]"),0===$parentsContainer.length&&($parentsContainer=t.closest("div[class=row]")),$parentsContainer},this.placeButtons=function(n){void 0===n&&(n="[data-control]"),t(n).each(function(){var n=t(this),e=t(n.attr("data-selector")),i=e.offset(),s=e.closest("div[class*=col-]"),a=parseInt(n.attr("data-moves"));if(e.hasClass("hidden")||!e.is(":visible"))return void(0===a?n.hide():n.fadeOut());n.fadeIn(),0===s.length&&(s=e.closest("div[class=row]"),0===s.length&&(s=e.parent().parent().siblings("div[class*=col-]").first(),0===s.length&&(s=e.closest("div[class^=row]"),0===s.length&&(console.log(" ERROR PARENT COL OR ROW NOT ROUND"),console.log("selector: "+n.attr("data-selector"))))));var r=o.right(s);o.right(s)+n.outerWidth(!0)>t("body").outerWidth(!0)&&(r=t("body").outerWidth(!0)-n.outerWidth(!0));var c=0===a?0:400;a++,n.attr("data-moves",a),n.css("position","absolute"),n.animate({top:i.top,left:r},c),n.unbind("mouseenter mouseleave"),o.buttonHover(n,e,s)})},this.right=function(t){var o=t.offset();return o.left+t.outerWidth()},this.topInView=function(o){var n=t(window),e=n.scrollTop(),i=e+n.height(),s=o.offset().top;s+o.height();return s>=e&&i>=s},this.windowScroll=function(){$button=t(".highlight-button"),1===$button.length&&($parent=t($button.attr("data-selector")),o.topInView($parent)?"fixed"===$button.css("position")&&$button.css("position","absolute").css("top",t(window).scrollTop()).animate({top:$parent.offset().top},400):"absolute"===$button.css("position")&&$button.css("position","fixed").css("top",-1*$button.outerHeight()).animate({top:"0px"},400))},this.addButton=function(n,e,i){var s=t("<button></button>"),a=t(i),r=o.parentColumn(a);a.hasClass("hidden")||!a.is(":visible"),null===n?s.attr("data-control",e):s.attr("data-control",n+"["+e+"]"),s.attr("data-selector",i),s.attr("data-moves",0),t("body").append(s),o.buttonHover(s,a,r)}},new BOLDGRID.Customizer_Edit(jQuery);