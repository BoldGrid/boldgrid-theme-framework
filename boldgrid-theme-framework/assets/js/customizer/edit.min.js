var BOLDGRID=BOLDGRID||{};BOLDGRID.Customizer_Edit=function(t){var o=this,i=parent.wp.customize;t(function(){setTimeout(o.init,500)}),this.addButtons=function(){var e,n={blogname:".site-title a",boldgrid_logo_setting:".logo-site-title",boldgrid_enable_footer:".attribution","entry-content":".entry-content","entry-title":".entry-title",blogdescription:".site-description"},a=_.keys(n),s=i.section("menu_locations").controls();_(a).each(function(t){o.addButton(null,t,n[t])}),t("aside.widget").each(function(){var i=t(this).attr("id");o.addButton("sidebar",i,"#"+i)}),t('aside[id^="black-studio-tinymce-"').each(function(){var i=t(this),e=i.attr("id"),n=e.replace("black-studio-tinymce-","").trim();o.addButton("widget_black-studio-tinymce",n,"#"+e)}),_(s).each(function(i){e=t("."+i.themeLocation.replace(/_/g,"-")+"-menu").find("ul").first().attr("id"),void 0!==e&&o.addButton("nav_menu",i.setting._value,"#"+e)})},this.bindEdit=function(){t("[data-control]").on("click",function(){var o=t(this).attr("data-control"),e=parent.window._wpCustomizeControlsL10n.cancel,n={width:400,resizable:!1,modal:!0},a=boldgridFrameworkCustomizerEdit.goThereNow;if(n.buttons={},n.buttons[a]=function(){parent.window.location=boldgridFrameworkCustomizerEdit.editPostLink},n.buttons[e]=function(){t(this).dialog("close")},"entry-content"==o||"entry-title"==o)return void t("#"+o).dialog(n);if(0===o.lastIndexOf("sidebar",0)){var s=o.match(/\[(.*?)\]/);i.Widgets.focusWidgetFormControl(s[1])}else i.control(o).focus();setTimeout(function(){var e=t(":focus",parent.document);"boldgrid_enable_footer"===o&&(e=t(i.control(o).selector,parent.document)),0===o.lastIndexOf("nav_menu",0)&&(e=t(".customize-control-nav_menu_name",parent.document)),o.startsWith("sidebar[")&&(e=e.closest(".widget")),e.css({"min-height":e.outerHeight(),"min-width":e.outerWidth()}).effect("bounce",{times:3,distance:10},"slow")},500)})},this.buttonHover=function(i,e,n){var a=e.offset(),s=n.offset(),r=t("#target-highlight"),c=e.outerHeight();0===c&&e.find("*").each(function(){var o=t(this).outerHeight();o>c&&(c=o)}),i.hover(function(){r.css("width",n.outerWidth()).css("height",c).css("top",a.top).css("left",s.left)},function(){r.css("width","0px").css("height","0px")}),e.hover(function(){i.addClass("highlight-button"),o.windowScroll()},function(){i.removeClass("highlight-button")})},this.fadeOut=function(){var o=t("[data-control]");o.css("opacity","0").animate({opacity:1},1e3,function(){o.animate({opacity:.5},500,function(){o.css("opacity","")})})},this.fixButtonPlacement=function(){var i='[data-control][style*="position: fixed"]:not(.highlight-button)';t(i).each(function(){var i=t(this),e=(t(i.attr("data-selector")),i.attr("data-control"));i.css("position","absolute").css("top",t(window).scrollTop()),o.placeButtons('[data-control="'+e+'"]')})},this.init=function(){o.addButtons(),o.placeButtons(),o.bindEdit(),o.fadeOut(),t(window).resize(function(){clearTimeout(t.data(this,"resizeTimer")),t.data(this,"resizeTimer",setTimeout(function(){o.placeButtons()},400))}),t(".navbar-toggle").click(function(){setTimeout(o.placeButtons,400)}),t(window).scroll(function(){clearTimeout(t.data(this,"scrollTimer")),t.data(this,"scrollTimer",setTimeout(function(){o.windowScroll(),o.fixButtonPlacement()},100))}),wp.customize.preview.bind("setting",function(i){clearTimeout(t.data(this,"previewBind")),t.data(this,"previewBind",setTimeout(function(){o.placeButtons()},400))})},this.parentColumn=function(t){var o=null,i=!1,e=["div[class*=col-]","div[class^=row]","div[class^=container]","div","p"];return _(e).each(function(e){!1===i&&(o=t.closest(e),o.length>0&&(i=!0))}),o},this.placeButtons=function(i){i=void 0===i?"[data-control]":i,t(i).each(function(){var i,e=t(this),n=t(e.attr("data-selector")),a=n.offset(),s=o.parentColumn(n),r=parseInt(e.attr("data-moves")),c=0===r?0:400;return n.hasClass("hidden")||!n.is(":visible")?void(0===r?e.hide():e.fadeOut()):(e.fadeIn(),i=o.right(s),o.right(s)+e.outerWidth(!0)>t("body").outerWidth(!0)&&(i=t("body").outerWidth(!0)-e.outerWidth(!0)),r++,e.attr("data-moves",r).css("position","absolute").animate({top:a.top,left:i},c),e.unbind("mouseenter mouseleave"),void o.buttonHover(e,n,s))})},this.right=function(t){return t.offset().left+t.outerWidth()},this.topInView=function(o){var i=t(window),e=i.scrollTop(),n=e+i.height(),a=o.offset().top;a+o.height();return 0===e&&0>a?!0:a>=e&&n>=a},this.windowScroll=function(){var i,e=t(".highlight-button");1===e.length&&(i=t(e.attr("data-selector")),o.topInView(i)?"fixed"===e.css("position")&&e.css("position","absolute").css("top",t(window).scrollTop()).animate({top:i.offset().top},400):"absolute"===e.css("position")&&e.css("position","fixed").css("top",-1*e.outerHeight()).animate({top:"0px"},400))},this.addButton=function(i,e,n){var a=t("<button></button>"),s=t(n),r=o.parentColumn(s),c=null===i?e:i+"["+e+"]";0===t("body").find('[data-selector="'+n+'"]').length&&(a.attr("data-control",c).attr("data-selector",n).attr("data-moves",0),t("body").append(a),o.buttonHover(a,s,r))}},new BOLDGRID.Customizer_Edit(jQuery);