var BOLDGRID=BOLDGRID||{};BOLDGRID.Customizer_Edit=function(t){var i=this,o=parent.wp.customize;i.buttonCollisionSet=1,i.targetHighlightTop=!0,i.userIsScrolling=!1,i.buttonHeight=0,i.buttonWidth=0,i.defaultZindex=210,this.addButtons=function(){var a,n=o.section("menu_locations").controls(),e=t(".empty-menu"),s=t("[data-empty-area=\"'true'\"]");_(boldgridFrameworkCustomizerEdit.buttons.general).each(function(o){1===t(o.selector).length&&i.addButton(null,o.control,o.selector,o.icon)}),t("aside.widget").each(function(){var o=t(this).attr("id");i.addButton("sidebar",o,"#"+o,"dashicons-edit")}),t('aside[id^="black-studio-tinymce-"]').each(function(){var o=t(this),a=o.attr("id"),n=a.replace("black-studio-tinymce-","").trim();i.addButton("widget_black-studio-tinymce",n,"#"+a,"dashicons-edit")}),_(n).each(function(o){a=t("."+o.themeLocation.replace(/_/g,"-")+"-menu-location").find("ul").first().attr("id"),void 0!==a&&i.addButton("nav_menu",o.setting._value,"#"+a,"dashicons-edit")}),_(e).each(function(o){i.addButton(null,"new_menu_name","#"+t(o).attr("id"),"dashicons-plus")}),_(s).each(function(o){t(o).append('<div class="empty-area"></div>');var a=t(o).attr("data-widget-area"),n=a.replace("accordion-section-sidebar-widgets-",""),e="[data-widget-area='"+a+"']";i.addButton("sidebars_widgets",n,e,"dashicons-plus")})},this.adjustEmptyMenus=function(){t(".empty-menu").parent(".navbar").addClass("empty-navbar")},this.buttonClick=function(i){var a,n,e=i.attr("data-control"),s=parent.window._wpCustomizeControlsL10n.cancel,r={width:400,resizable:!1,modal:!0},d=boldgridFrameworkCustomizerEdit.goThereNow,l=t(i.attr("data-selector")),u=t(".collapse-sidebar",parent.document),c=t(".customize-controls-preview-toggle .controls",parent.document),h=t(".wp-full-overlay",parent.document);if(r.buttons={},r.buttons[d]=function(){parent.window.location=boldgridFrameworkCustomizerEdit.editPostLink},r.buttons[s]=function(){t(this).dialog("close")},"false"===u.attr("aria-expanded")&&u.click(),c.is(":visible")&&h.toggleClass("preview-only"),"entry-content"===e||"entry-title"===e)return void t("#"+e).dialog(r);if(0===e.lastIndexOf("sidebars_widgets",0))o.control(e).focus();else if(0===e.lastIndexOf("sidebar",0)){if(n=e.match(/\[(.*?)\]/),o.Widgets.focusWidgetFormControl(n[1]),n[1].startsWith("black-studio-tinymce-"))return}else"new_menu_name"===e?(a=l.attr("data-theme-location"),o.control("nav_menu_locations["+a+"]").focus()):o.control(e).focus();setTimeout(function(){var i,a=t(":focus",parent.document);"hide_boldgrid_attribution"===e&&(a=t(o.control("hide_boldgrid_attribution").selector,parent.document).add(o.control("hide_wordpress_attribution").selector,parent.document).add(o.control("hide_partner_attribution").selector,parent.document)),0===e.lastIndexOf("nav_menu",0)&&(a=t(".customize-control-nav_menu_name",parent.document)),e.startsWith("sidebar[")&&(a=a.closest(".widget")),i=a.css("transition"),a.css({"min-height":a.outerHeight(),"min-width":a.outerWidth(),transition:"all 0s"}).effect("bounce",{times:3,distance:10},"slow",function(){t(this).css("transition",i)})},500)},this.buttonMouseEnter=function(o,a,n){var e,s=a.offset().top,r=n.offset(),d=a.outerHeight();0===d&&a.find("*").each(function(){var i=t(this).outerHeight();i>d&&(d=i)}),"1"===o.attr("data-fixed-ancestor")?(i.$targetHighlight.css("position","fixed"),s=a.offset().top-t(window).scrollTop()):i.$targetHighlight.css("position","absolute"),i.$targetHighlight.stop(!0).css("width",n.outerWidth()).css("height",d).css("top",s).css("left",r.left).css("visibility","visible");var l=0;i.targetHighlightTop=setInterval(function(){l+=10,s="1"===o.attr("data-fixed-ancestor")?a.offset().top-t(window).scrollTop():a.offset().top,i.$targetHighlight.css("top",s),l>=400&&clearInterval(i.targetHighlightTop)},10),o.hasClass("new")&&(e=parseInt(o.attr("data-with-title-width")),o.stop(!0).html(" "+o.attr("data-title")).animate({"max-width":e+"px",left:i.right(o)-e},400)),i.isParentEmpty(a)&&(a.stop(!0).animate({height:i.buttonHeight},400),i.$targetHighlight.stop(!0).css("visibility","visible").animate({height:i.buttonHeight},400))},this.buttonMouseLeave=function(t,o){t.hasClass("new")&&t.stop(!0).animate({"max-width":30,left:t.attr("data-left")},400,function(){t.html("")}),clearInterval(i.targetHighlightTop),i.isParentEmpty(o)?(o.stop(!0).animate({height:"0px"},500),i.$targetHighlight.height()<=2?i.$targetHighlight.css("visibility","hidden"):i.$targetHighlight.stop(!0).animate({height:"0px"},400,function(){i.$targetHighlight.css("visibility","hidden")})):i.$targetHighlight.css("visibility","hidden")},this.collide=function(t,i){var o=parseInt(t.attr("data-left")),a=parseInt(i.attr("data-left")),n=parseInt(t.attr("data-top")),e=parseInt(i.attr("data-top")),s=t.outerHeight(!0),r=i.outerHeight(!0),d=t.outerWidth(!0),l=i.outerWidth(!0),u=n+s,c=o+d,h=e+r,p=a+l;return!(u<e||n>h||c<a||o>p)},this.findCollision=function(){var o=[],a=t(".site-footer").last(),n=a.offset().top+a.outerHeight(!0);i.buttonCollisionSet=1,t("button[data-control]:visible").each(function(){o.push(t(this))}),o.sort(i.sortButtonsAsc),t.each(o,function(a,n){a<o.length-1&&($buttonA=t(n),t.each(o,function(o,a){$buttonB=t(a),$buttonA.is($buttonB)||i.collide($buttonA,$buttonB)&&i.fixCollision($buttonA,$buttonB)}))}),o.sort(i.sortButtonsDesc),_(o).each(function(i,o){var a=t(i),e=parseInt(a.attr("data-top"))+a.outerHeight(!0);if(e>n){var s=e-n,r=a.attr("data-collision-set");"undefined"!=typeof r&&t.each(t("[data-collision-set="+r+"]"),function(){var i=t(this),o=parseInt(i.attr("data-top")-s);i.attr("data-top",o)})}})},this.fixButtonPlacement=function(){var o='[data-control][style*="position: fixed"][data-fixed-ancestor="0"]:not(.highlight-button)';t(o).each(function(){var o=t(this);t(o.attr("data-selector")),o.attr("data-control");o.css("position","absolute").css("top",t(window).scrollTop()),i.placeButton(o),i.findCollision()})},this.fixCollision=function(t,o){var a=parseInt(t.attr("data-top")),n=parseInt(o.attr("data-top")),e=a>n?t:o,s=t.is(e)?o:t,r=s.attr("data-collision-set");e.attr("data-top",parseInt(s.attr("data-top"))+i.buttonHeight),"undefined"==typeof r&&(r=i.buttonCollisionSet,i.buttonCollisionSet++),e.attr("data-collision-set",r),s.attr("data-collision-set",r)},this.getFixedAncestors=function(i){var o=i.parents().filter(function(){return"fixed"===t(this).css("position")});return o},this.init=function(){i.$targetHighlight=t("#target-highlight"),i.addButtons(),i.buttonHeight=t("button[data-control]:visible").first().outerHeight(),i.buttonWidth=t("button[data-control]:visible").first().outerWidth(),i.placeButtons(),t(window).resize(function(){clearTimeout(t.data(this,"resizeTimer")),t.data(this,"resizeTimer",setTimeout(function(){i.placeButtons()},400))}),t(".navbar-toggle").click(function(){setTimeout(i.placeButtons,400)}),t(window).scroll(function(){i.userIsScrolling=!0,clearTimeout(t.data(this,"scrollTimer")),t.data(this,"scrollTimer",setTimeout(function(){i.userIsScrolling=!1,i.windowScroll()},100))}),wp.customize.preview.bind("setting",function(o){clearTimeout(t.data(this,"previewBind")),t.data(this,"previewBind",setTimeout(function(){i.placeButtons()},400))})},this.inView=function(i){var o=t(window),a=o.scrollTop(),n=a+o.height(),e=i.offset().top,s=e+i.height();return e<=n&&s>=a},this.isParentEmpty=function(t){return t.hasClass("empty-menu")||"'true'"===t.attr("data-empty-area")},this.parentColumn=function(t){var i=null,o=!1,a=["div[class*=col-]","div[class^=row]","div[class^=container]","div","p"];return _(a).each(function(a){!1===o&&(i=t.closest(a),i.length>0&&(o=!0))}),i},this.placeButton=function(o){var a,n=t(o.attr("data-selector")),e=n.offset(),s=i.parentColumn(n),r=parseInt(o.attr("data-moves")),d=0===r?0:400,l=i.getFixedAncestors(n),u=l.length>0?"1":"0",c="absolute",h=i.right(s),p=t("body").outerWidth(!0);return o.attr("data-fixed-ancestor",u),l.length?(zIndex=parseInt(l.last().css("z-index")),Number.isInteger(zIndex)&&zIndex>i.defaultZindex&&o.css("z-index",zIndex+1)):o.css("z-index",""),n.hasClass("hidden")||n.hasClass("invisible")||!n.is(":visible")?void(0===r?o.hide():o.fadeOut()):(o.fadeIn(),h+i.buttonWidth>p&&(h=p-i.buttonWidth),"1"===o.attr("data-fixed-ancestor")?(c="fixed",a=e.top-t(window).scrollTop()):a=e.top,r++,void o.attr("data-last-animation","placeButton").attr("data-moves",r).attr("data-top",a).attr("data-left",h).attr("data-duration",d).css("position",c).removeAttr("data-collision-set"))},this.placeButtons=function(){t("button[data-control]").each(function(){$button=t(this),i.placeButton($button)}),i.findCollision(),i.positionByData()},i.positionByData=function(){t("button[data-control]").each(function(){$button=t(this),$button.hasClass("highlight-button")&&"fixed"===$button.css("position")||$button.hasClass("new")&&$button.is(":animated")||$button.attr("data-last-animation","positionByData").animate({top:parseInt($button.attr("data-top")),left:parseInt($button.attr("data-left"))},parseInt($button.attr("data-duration")))})},this.right=function(t,i){return i=void 0!==i&&i,t.offset().left+t.outerWidth(i)},this.sortButtonsAsc=function(o,a){var n,e,s,r,d=o.offset().top,l=a.offset().top;return d===l&&(n=t(o.attr("data-selector")),s=n.offset().top,i.isParentEmpty(n)&&(s-=1),d=s,e=t(a.attr("data-selector")),r=e.offset().top,i.isParentEmpty(e)&&(r-=1),l=r),d<l?-1:d>l?1:0},this.sortButtonsDesc=function(t,i){var o=t.offset().top,a=i.offset().top;return a<o?-1:a>o?1:0},this.topInView=function(i){var o=t(window),a=o.scrollTop(),n=a+o.height(),e=i.offset().top;e+i.height();return 0===a&&e<0||e>=a&&e<=n},this.windowScroll=function(){var o='[data-control][style*="position: fixed"][data-fixed-ancestor="0"]:not(.highlight-button)';if(t(o).each(function(){var o=t(this),a=t(o.attr("data-selector"));o.attr("data-control");o.css("position","absolute").css("top",t(window).scrollTop()),i.topInView(a)?(i.placeButton(o),i.findCollision(),i.positionByData()):o.attr("data-last-animation","animation-c").animate({top:"-="+i.buttonHeight},400,function(){i.placeButton(o),i.findCollision(),i.positionByData()})}),$button=t('.highlight-button[data-control][data-fixed-ancestor="0"]'),1===$button.length){if($parent=t($button.attr("data-selector")),buttonIsFixed="fixed"===$button.css("position"),i.topInView($parent)&&buttonIsFixed)return $button.attr("data-last-animation","animation-b").css("position","absolute").css("top",t(window).scrollTop()),i.placeButton($button),i.findCollision(),void i.positionByData();if(!i.topInView($parent)&&!buttonIsFixed)return void $button.stop(!0).attr("data-last-animation","animation-a").css("position","fixed").css("top",-1*$button.outerHeight()).animate({top:"0px"},400);if(!i.inView($parent)&&buttonIsFixed)return void $button.animate({top:"-="+i.buttonHeight},400,function(){i.placeButton($button),i.findCollision(),i.positionByData()})}},this.addButton=function(o,a,n,e){var s=t("<button></button>"),r=t(n),d=i.parentColumn(r),l=null===o?a:o+"["+a+"]",u=i.getFixedAncestors(r),c=u.length>0?"1":"0",h="'true'"===r.attr("data-empty-area"),p=r.hasClass("empty-menu");0===t("body").find('[data-selector="'+n+'"]').length&&(e=void 0===e?"dashicons-edit":e,s.addClass(e),p&&s.addClass("new").attr("data-title",boldgridFrameworkCustomizerEdit.menu),h&&s.addClass("new").attr("data-title",boldgridFrameworkCustomizerEdit.widget),s.attr("data-control",l).attr("data-selector",n).attr("data-moves",0).attr("data-fixed-ancestor",c),t("body").append(s),(p||h)&&s.css("max-width","100%").html(" "+s.attr("data-title")).attr("data-with-title-width",s.outerWidth(!0)).css("max-width","").html(""),s.hover(function(){i.buttonMouseEnter(s,r,d)},function(){i.buttonMouseLeave(s,r)}),s.on("click",function(){i.buttonClick(s)}),r.hover(function(){s.addClass("highlight-button"),i.topInView(r)||"fixed"===s.css("position")||!1!==i.userIsScrolling||s.attr("data-last-animation","ancar").css("position","fixed").css("top",-1*s.outerHeight()).animate({top:"0px"},400)},function(){s.removeClass("highlight-button")}))},t(function(){i.adjustEmptyMenus()}),t(window).on("load",function(){i.init(),setTimeout(function(){i.placeButtons()},3e3)})},new BOLDGRID.Customizer_Edit(jQuery);