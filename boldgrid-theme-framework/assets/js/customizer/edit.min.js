var BOLDGRID=BOLDGRID||{};BOLDGRID.CustomizerEdit=BOLDGRID.CustomizerEdit||{},function(t){"use strict";var i,o,e;o=BOLDGRID,e=parent.wp.customize,BOLDGRID.CustomizerEdit={i18n:window.boldgridFrameworkCustomizerEdit||{},buttonCollisionSet:1,targetHighlightTop:!0,userIsScrolling:!1,buttonHeight:0,buttonWidth:0,defaultZindex:210,init:function(){i._onReady(),i._onLoad()},_onReady:function(){t(document).ready(i.adjustEmptyMenus)},_onLoad:function(){t(window).on("load",function(){i.start(),i._customizer(),setTimeout(function(){i.placeButtons()},3e3)})},_customizer:function(){wp.customize.preview.bind("setting",function(){clearTimeout(t.data(this,"previewBind")),t.data(this,"previewBind",setTimeout(function(){BOLDGRID.CustomizerEdit.placeButtons()},400))}),wp.customize.selectiveRefresh.bind("partial-content-rendered",function(){BOLDGRID.CustomizerEdit.destroy(),BOLDGRID.CustomizerEdit.start()}),t(document).on("customize-preview-menu-refreshed",function(){BOLDGRID.CustomizerEdit.destroy(),BOLDGRID.CustomizerEdit.start()})},start:function(){i.$targetHighlight=t("#target-highlight"),i.addButtons(),i.buttonHeight=t("button[data-control]:visible").first().outerHeight(),i.buttonWidth=t("button[data-control]:visible").first().outerWidth(),i.placeButtons(),t(window).resize(function(){clearTimeout(t.data(this,"resizeTimer")),t.data(this,"resizeTimer",setTimeout(function(){i.placeButtons()},400))}),t(".navbar-toggle").click(function(){setTimeout(i.placeButtons,400)}),t(window).scroll(function(){i.userIsScrolling=!0,clearTimeout(t.data(this,"scrollTimer")),t.data(this,"scrollTimer",setTimeout(function(){i.userIsScrolling=!1,i.windowScroll()},100))})},addButtons:function(){var o,n=_.isFunction(e.section)?e.section("menu_locations").controls():[],a=t(".empty-menu"),s=t('[data-empty-area="true"]');_(i.i18n.buttons.general).each(function(o){1===t(o.selector).length&&i.addButton(null,o.control,o.selector,o.icon)}),t("aside.widget").each(function(){var o=t(this).attr("id");i.addButton("sidebar",o,"#"+o,"dashicons-edit")}),t('aside[id^="black-studio-tinymce-"]').each(function(){var o=t(this),e=o.attr("id"),n=e.replace("black-studio-tinymce-","").trim();i.addButton("widget_black-studio-tinymce",n,"#"+e,"dashicons-edit")}),_(n).each(function(e){o=t("."+e.themeLocation.replace(/_/g,"-")+"-menu-location").find("ul").first().attr("id"),_.isUndefined(o)||i.addButton("nav_menu",e.setting._value,"#"+o,"dashicons-edit")}),_(a).each(function(o){i.addButton(null,"new_menu_name","#"+t(o).attr("id"),"dashicons-plus")}),_(s).each(function(o){var e,n,a;t(o).append('<div class="empty-area"></div>'),e=t(o).attr("data-widget-area"),n=e.replace("accordion-section-sidebar-widgets-",""),a="[data-widget-area='"+e+"']",i.addButton("sidebars_widgets",n,a,"dashicons-plus")})},adjustEmptyMenus:function(){t(".empty-menu").parent(".navbar").addClass("empty-navbar")},buttonClick:function(o){var n,a,s=o.attr("data-control"),r=parent.window._wpCustomizeControlsL10n.cancel,d={width:400,resizable:!1,modal:!0},l=i.i18n.goThereNow,c=t(o.attr("data-selector")),u=t(".collapse-sidebar",parent.document),h=t(".customize-controls-preview-toggle .controls",parent.document),f=t(".wp-full-overlay",parent.document);if(d.buttons={},d.buttons[l]=function(){parent.window.location=i.i18n.editPostLink},d.buttons[r]=function(){t(this).dialog("close")},"false"===u.attr("aria-expanded")&&u.click(),h.is(":visible")&&f.toggleClass("preview-only"),"entry-content"===s||"entry-title"===s)return void t("#"+s).dialog(d);if(0===s.lastIndexOf("sidebars_widgets",0))e.control(s).focus();else if(0===s.lastIndexOf("sidebar",0)){if(a=s.match(/\[(.*?)\]/),e.Widgets.focusWidgetFormControl(a[1]),a[1].startsWith("black-studio-tinymce-"))return}else"new_menu_name"===s?(n=c.attr("data-theme-location"),e.control("nav_menu_locations["+n+"]").focus()):e.control(s).focus();setTimeout(function(){var i,o=t(":focus",parent.document);"hide_boldgrid_attribution"===s&&(o=t('ul#sub-accordion-section-boldgrid_footer_panel > li[id^="customize-control-hide_"][id$="_attribution"]',parent.document)),"hide_boldgrid_attribution"===s&&0==e("boldgrid_enable_footer")()&&(o=t(e.control("boldgrid_enable_footer").selector,parent.document)),0===s.lastIndexOf("nav_menu",0)&&(o=t(".customize-control-nav_menu_name",parent.document)),s.startsWith("sidebar[")&&(o=o.closest(".widget")),i=o.css("transition"),o.css({"min-height":o.outerHeight(),"min-width":o.outerWidth(),transition:"all 0s"}).effect("bounce",{times:3,distance:10},"slow",function(){t(this).css("transition",i)})},500)},buttonMouseEnter:function(o,e,n){var a,s=e.offset().top,r=n.offset(),d=e.outerHeight(),l=0;0===d&&e.find("*").each(function(){var i=t(this).outerHeight();i>d&&(d=i)}),"1"===o.attr("data-fixed-ancestor")?(i.$targetHighlight.css("position","fixed"),s=e.offset().top-t(window).scrollTop()):i.$targetHighlight.css("position","absolute"),i.$targetHighlight.stop(!0).css("width",n.outerWidth()).css("height",d).css("top",s).css("left",r.left).css("visibility","visible"),i.targetHighlightTop=setInterval(function(){l+=10,s="1"===o.attr("data-fixed-ancestor")?e.offset().top-t(window).scrollTop():e.offset().top,i.$targetHighlight.css("top",s),l>=400&&clearInterval(i.targetHighlightTop)},10),o.hasClass("new")&&(a=parseInt(o.attr("data-with-title-width")),o.stop(!0).html(" "+o.attr("data-title")).animate({"max-width":a+"px",left:i.right(o)-a},400)),i.isParentEmpty(e)&&(e.stop(!0).animate({height:i.buttonHeight},400),i.$targetHighlight.stop(!0).css("visibility","visible").animate({height:i.buttonHeight},400))},buttonMouseLeave:function(t,o){t.hasClass("new")&&t.stop(!0).animate({"max-width":30,left:t.attr("data-left")},400,function(){t.html("")}),clearInterval(i.targetHighlightTop),i.isParentEmpty(o)?(o.stop(!0).animate({height:"0px"},500),i.$targetHighlight.height()<=2?i.$targetHighlight.css("visibility","hidden"):i.$targetHighlight.stop(!0).animate({height:"0px"},400,function(){i.$targetHighlight.css("visibility","hidden")})):i.$targetHighlight.css("visibility","hidden")},collide:function(t,i){var o=!0,e=parseInt(t.attr("data-left")),n=parseInt(i.attr("data-left")),a=parseInt(t.attr("data-top")),s=parseInt(i.attr("data-top")),r=t.outerHeight(!0),d=i.outerHeight(!0),l=t.outerWidth(!0),c=i.outerWidth(!0),u=a+r,h=e+l,f=s+d,p=n+c;return(u<s||a>f||h<n||e>p)&&(o=!1),o},findCollision:function(){var o=[],e=t(".site-footer").last(),n=e.offset().top+e.outerHeight(!0);i.buttonCollisionSet=1,t("button[data-control]:visible").each(function(){o.push(t(this))}),o.sort(i.sortButtonsAsc),t.each(o,function(e,n){var a=t(n);e<o.length-1&&t.each(o,function(o,e){var n=t(e);a.is(n)||i.collide(a,n)&&i.fixCollision(a,n)})}),o.sort(i.sortButtonsDesc),_(o).each(function(i){var o,e,a=t(i),s=parseInt(a.attr("data-top"))+a.outerHeight(!0);s>n&&(o=s-n,e=a.attr("data-collision-set"),_.isUndefined(e)||t.each(t("[data-collision-set="+e+"]"),function(){var i=t(this),e=parseInt(i.attr("data-top")-o);i.attr("data-top",e)}))})},fixButtonPlacement:function(){var o='[data-control][style*="position: fixed"][data-fixed-ancestor="0"]:not(.highlight-button)';t(o).each(function(){var o=t(this);o.css("position","absolute").css("top",t(window).scrollTop()),i.placeButton(o),i.findCollision()})},fixCollision:function(t,o){var e=parseInt(t.attr("data-top")),n=parseInt(o.attr("data-top")),a=e>n?t:o,s=t.is(a)?o:t,r=s.attr("data-collision-set");a.attr("data-top",parseInt(s.attr("data-top"))+i.buttonHeight),"undefined"==typeof r&&(r=i.buttonCollisionSet,i.buttonCollisionSet++),a.attr("data-collision-set",r),s.attr("data-collision-set",r)},getFixedAncestors:function(i){var o=i.parents().filter(function(){return"fixed"===t(this).css("position")});return o},inView:function(i){var o=t(window),e=o.scrollTop(),n=e+o.height(),a=i.offset().top,s=a+i.height();return a<=n&&s>=e},isParentEmpty:function(t){return t.hasClass("empty-menu")||t.attr("data-empty-area")},parentColumn:function(t){var i=null,o=!1,e=["div[class*=col-]","div[class^=row]","div[class^=container]","div","p"];return _(e).each(function(e){!1===o&&(i=t.closest(e),i.length>0&&(o=!0))}),i},placeButton:function(o){var e,n,a=t(o.attr("data-selector")),s=a.offset(),r=i.parentColumn(a),d=parseInt(o.attr("data-moves")),l=0===d?0:400,c=i.getFixedAncestors(a),u=c.length>0?"1":"0",h="absolute",f=i.right(r),p=t("body").outerWidth(!0);return o.attr("data-fixed-ancestor",u),c.length?(e=parseInt(c.last().css("z-index")),Number.isInteger(e)&&e>i.defaultZindex&&o.css("z-index",e+1)):o.css("z-index",""),a.hasClass("hidden")||a.hasClass("invisible")||!a.is(":visible")?void(0===d?o.hide():o.fadeOut()):(o.fadeIn(),f+i.buttonWidth>p&&(f=p-i.buttonWidth),"1"===o.attr("data-fixed-ancestor")?(h="fixed",n=s.top-t(window).scrollTop()):n=s.top,d++,void o.attr({"data-last-animation":"placeButton","data-moves":d,"data-top":n,"data-left":f,"data-duration":l}).css("position",h).removeAttr("data-collision-set"))},placeButtons:function(){t("button[data-control]").each(function(){var o=t(this).data("selector");t(o).length?i.placeButton(t(this)):i.removeButton(t(this))}),i.findCollision(),i.positionByData()},positionByData:function(){t("button[data-control]").each(function(){var i=t(this);i.hasClass("highlight-button")&&"fixed"===i.css("position")||i.hasClass("new")&&i.is(":animated")||i.attr("data-last-animation","positionByData").animate({top:parseInt(i.attr("data-top")),left:parseInt(i.attr("data-left"))},parseInt(i.attr("data-duration")))})},right:function(t,i){return i=!_.isUndefined(i)&&i,t.offset().left+t.outerWidth(i)},sortButtonsAsc:function(o,e){var n,a,s,r,d=o.offset().top,l=e.offset().top;return d===l&&(n=t(o.attr("data-selector")),s=n.offset().top,i.isParentEmpty(n)&&(s-=1),d=s,a=t(e.attr("data-selector")),r=a.offset().top,i.isParentEmpty(a)&&(r-=1),l=r),d<l?-1:d>l?1:0},sortButtonsDesc:function(t,i){var o=t.offset().top,e=i.offset().top;return e<o?-1:e>o?1:0},topInView:function(i){var o=t(window),e=o.scrollTop(),n=e+o.height(),a=i.offset().top;return 0===e&&a<0||a>=e&&a<=n},windowScroll:function(){var o,e,n,a='[data-control][style*="position: fixed"][data-fixed-ancestor="0"]:not(.highlight-button)';if(t(a).each(function(){var o=t(this),e=t(o.attr("data-selector"));o.css("position","absolute").css("top",t(window).scrollTop()),i.topInView(e)?(i.placeButton(o),i.findCollision(),i.positionByData()):o.attr("data-last-animation","animation-c").animate({top:"-="+i.buttonHeight},400,function(){i.placeButton(o),i.findCollision(),i.positionByData()})}),o=t('.highlight-button[data-control][data-fixed-ancestor="0"]'),1===o.length){if(e=t(o.attr("data-selector")),n="fixed"===o.css("position"),i.topInView(e)&&n)return o.attr("data-last-animation","animation-b").css("position","absolute").css("top",t(window).scrollTop()),i.placeButton(o),i.findCollision(),void i.positionByData();if(!i.topInView(e)&&!n)return void o.stop(!0).attr("data-last-animation","animation-a").css("position","fixed").css("top",-1*o.outerHeight()).animate({top:"0px"},400);if(!i.inView(e)&&n)return void o.animate({top:"-="+i.buttonHeight},400,function(){i.placeButton(o),i.findCollision(),i.positionByData()})}},addButton:function(o,e,n,a){var s=t("<button></button>"),r=t(n),d=i.parentColumn(r),l=null===o?e:o+"["+e+"]",c=i.getFixedAncestors(r),u=c.length>0?"1":"0",h=r.attr("data-empty-area"),f=r.hasClass("empty-menu");0===t("body").find('[data-selector="'+n+'"]').length&&(a=_.isUndefined(a)?"dashicons-edit":a,s.addClass(a),f&&s.addClass("new").attr("data-title",i.i18n.menu),h&&s.addClass("new").attr("data-title",i.i18n.widget),s.attr({"data-control":l,"data-selector":n,"data-moves":0,"data-fixed-ancestor":u}),t("body").append(s),(f||h)&&s.css("max-width","100%").html(" "+s.attr("data-title")).attr("data-with-title-width",s.outerWidth(!0)).css("max-width","").html(""),s.hover(function(){i.buttonMouseEnter(s,r,d)},function(){i.buttonMouseLeave(s,r)}),s.on("click",function(){i.buttonClick(s)}),r.hover(function(){s.addClass("highlight-button"),i.topInView(r)||"fixed"===s.css("position")||!1!==i.userIsScrolling||s.attr("data-last-animation","ancar").css("position","fixed").css("top",-1*s.outerHeight()).animate({top:"0px"},400)},function(){s.removeClass("highlight-button")}))},removeButton:function(t){t.remove()},destroy:function(){t("button[data-control]").remove()}},i=BOLDGRID.CustomizerEdit}(jQuery),BOLDGRID.CustomizerEdit.init();