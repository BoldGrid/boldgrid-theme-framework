var BOLDGRID=BOLDGRID||{};BOLDGRID.Customizer_Edit=function(t){var e=this,i=parent.wp.customize;t(function(){setTimeout(e.init,500)}),this.addButtons=function(){var o,n={blogname:".site-title a",boldgrid_logo_setting:".logo-site-title",boldgrid_enable_footer:".attribution","entry-content":".entry-content","entry-title":".entry-title",blogdescription:".site-description"},a=_.keys(n),s=i.section("menu_locations").controls(),r=t(".empty-menu"),d=t("[data-empty-area=\"'true'\"]");_(a).each(function(t){e.addButton(null,t,n[t])}),t("aside.widget").each(function(){var i=t(this).attr("id");e.addButton("sidebar",i,"#"+i)}),t('aside[id^="black-studio-tinymce-"').each(function(){var i=t(this),o=i.attr("id"),n=o.replace("black-studio-tinymce-","").trim();e.addButton("widget_black-studio-tinymce",n,"#"+o)}),_(s).each(function(i){o=t("."+i.themeLocation.replace(/_/g,"-")+"-menu").find("ul").first().attr("id"),void 0!==o&&e.addButton("nav_menu",i.setting._value,"#"+o)}),_(r).each(function(i){e.addButton(null,"new_menu_name","#"+t(i).attr("id"))}),_(d).each(function(i){t(i).append('<div class="empty-area"></div>');var o=t(i).attr("data-widget-area"),n=o.replace("accordion-section-sidebar-widgets-",""),a="[data-widget-area='"+o+"']";e.addButton("sidebars_widgets",n,a)})},this.buttonClick=function(e){var o=e.attr("data-control"),n=parent.window._wpCustomizeControlsL10n.cancel,a={width:400,resizable:!1,modal:!0},s=boldgridFrameworkCustomizerEdit.goThereNow;if(a.buttons={},a.buttons[s]=function(){parent.window.location=boldgridFrameworkCustomizerEdit.editPostLink},a.buttons[n]=function(){t(this).dialog("close")},"entry-content"===o||"entry-title"===o)return void t("#"+o).dialog(a);if(0===o.lastIndexOf("sidebars_widgets",0))i.control(o).focus();else if(0===o.lastIndexOf("sidebar",0)){var r=o.match(/\[(.*?)\]/);i.Widgets.focusWidgetFormControl(r[1])}else"new_menu_name"===o?i.panel("nav_menus").expand():i.control(o).focus();setTimeout(function(){var e,n=t(":focus",parent.document);"boldgrid_enable_footer"===o&&(n=t(i.control(o).selector,parent.document)),0===o.lastIndexOf("nav_menu",0)&&(n=t(".customize-control-nav_menu_name",parent.document)),o.startsWith("sidebar[")&&(n=n.closest(".widget")),"new_menu_name"===o&&(n=t(".add-menu-toggle",parent.document)),e=n.css("transition"),n.css({"min-height":n.outerHeight(),"min-width":n.outerWidth(),transition:"all 0s"}).effect("bounce",{times:3,distance:10},"slow",function(){t(this).css("transition",e)})},500)},this.buttonMouseEnter=function(i,o,n){var a=o.offset().top,s=n.offset(),r=o.outerHeight();0===r&&o.find("*").each(function(){var e=t(this).outerHeight();e>r&&(r=e)}),"1"===i.attr("data-fixed-ancestor")?(e.$targetHighlight.css("position","fixed"),a=o.offset().top-t(window).scrollTop()):e.$targetHighlight.css("position","absolute"),e.$targetHighlight.css("width",n.outerWidth()).css("height",r).css("top",a).css("left",s.left).css("visibility","visible")},this.buttonMouseLeave=function(t){e.$targetHighlight.css("visibility","hidden")},this.fixButtonPlacement=function(){var i='[data-control][style*="position: fixed"][data-fixed-ancestor="0"]:not(.highlight-button)';t(i).each(function(){var i=t(this);t(i.attr("data-selector")),i.attr("data-control");i.css("position","absolute").css("top",t(window).scrollTop()),e.placeButton(i)})},this.getFixedAncestors=function(e){var i=e.parents().filter(function(){return"fixed"===t(this).css("position")});return i},this.init=function(){e.$targetHighlight=t("#target-highlight"),e.addButtons(),e.placeButtons(),setTimeout(function(){e.placeButton(t("button[data-control=boldgrid_enable_footer]"))},1e3),t(window).resize(function(){clearTimeout(t.data(this,"resizeTimer")),t.data(this,"resizeTimer",setTimeout(function(){e.placeButtons()},400))}),t(".navbar-toggle").click(function(){setTimeout(e.placeButtons,400)}),t(window).scroll(function(){clearTimeout(t.data(this,"scrollTimer")),t.data(this,"scrollTimer",setTimeout(function(){e.windowScroll(),e.fixButtonPlacement()},100))}),wp.customize.preview.bind("setting",function(i){clearTimeout(t.data(this,"previewBind")),t.data(this,"previewBind",setTimeout(function(){e.placeButtons()},400))})},this.parentColumn=function(t){var e=null,i=!1,o=["div[class*=col-]","div[class^=row]","div[class^=container]","div","p"];return _(o).each(function(o){!1===i&&(e=t.closest(o),e.length>0&&(i=!0))}),e},this.placeButton=function(i){var o,n,a=t(i.attr("data-selector")),s=a.offset(),r=e.parentColumn(a),d=parseInt(i.attr("data-moves")),c=0===d?0:400,u=e.getFixedAncestors(a),l=u.length>0?"1":"0";if(i.attr("data-fixed-ancestor",l),u.length&&(n=parseInt(u.last().css("z-index")),Number.isInteger(n)&&i.css("z-index",n+1)),a.hasClass("hidden")||a.hasClass("invisible")||!a.is(":visible"))return void(0===d?i.hide():i.fadeOut());i.fadeIn(),o=e.right(r),e.right(r)+i.outerWidth(!0)>t("body").outerWidth(!0)&&(o=t("body").outerWidth(!0)-i.outerWidth(!0));var h="absolute",f=s.top;"1"===i.attr("data-fixed-ancestor")&&(h="fixed",f=s.top-t(window).scrollTop()),d++,i.attr("data-moves",d).css("position",h).animate({top:f,left:o},c)},this.placeButtons=function(){t("button[data-control]").each(function(){$button=t(this),e.placeButton($button)})},this.right=function(t){return t.offset().left+t.outerWidth()},this.topInView=function(e){var i=t(window),o=i.scrollTop(),n=o+i.height(),a=e.offset().top;a+e.height();return 0===o&&0>a?!0:a>=o&&n>=a},this.windowScroll=function(){var i,o=t(".highlight-button");1===o.length&&"1"!==o.attr("data-fixed-ancestor")&&(i=t(o.attr("data-selector")),e.topInView(i)?"fixed"===o.css("position")&&o.css("position","absolute").css("top",t(window).scrollTop()).animate({top:i.offset().top},400):"absolute"===o.css("position")&&o.css("position","fixed").css("top",-1*o.outerHeight()).animate({top:"0px"},400))},this.addButton=function(i,o,n){var a=t("<button></button>"),s=t(n),r=e.parentColumn(s),d=null===i?o:i+"["+o+"]",c=e.getFixedAncestors(s),u=c.length>0?"1":"0",l="'true'"===s.attr("data-empty-area"),h=s.hasClass("empty-menu");0===t("body").find('[data-selector="'+n+'"]').length&&(h&&a.addClass("new").attr("title",boldgridFrameworkCustomizerEdit.addAMenu),l&&a.addClass("new").attr("title",boldgridFrameworkCustomizerEdit.addAWidget),a.attr("data-control",d).attr("data-selector",n).attr("data-moves",0).attr("data-fixed-ancestor",u),t("body").append(a),a.hover(function(){e.buttonMouseEnter(a,s,r)},function(){e.buttonMouseLeave(r)}),a.on("click",function(){e.buttonClick(a)}),s.hover(function(){a.addClass("highlight-button"),e.windowScroll()},function(){a.removeClass("highlight-button")}))}},new BOLDGRID.Customizer_Edit(jQuery);