import{BorderRadius}from"@boldgrid/controls/src/controls/border-radius";import{Margin}from"@boldgrid/controls/src/controls/margin";import{Padding}from"@boldgrid/controls/src/controls/padding";import{BoxShadow}from"@boldgrid/controls/src/controls/box-shadow";import{Border}from"@boldgrid/controls/src/controls/border";import{MultiSlider}from"@boldgrid/controls/src/controls/multi-slider";import{PaletteSelector}from"../color/palette-selector";import"../../../scss/customizer/controls/_generic.scss";var $=window.jQuery;export class Control{constructor(){this.classes={BorderRadius:BorderRadius,BoxShadow:BoxShadow,MultiSlider:MultiSlider,Border:Border,Padding:Padding,Margin:Margin}}init(){return $(()=>this._bindConfigs()),this}_bindConfigs(){wp.customize.control.each(o=>{o.params.choices&&"boldgrid_controls"===o.params.choices.name&&this._setupControl(o)})}_setupControl(o){let t,e=o.params.choices.settings||{};this._setDefaults(o,e),t=new this.classes[o.params.choices.type](e),this._bindRender(o,t),this._bindChangeEvent(o,t)}_setDefaults(o,t){let e=o.setting.get()||!1;if(_.isObject(e)){t.defaults=e;try{t.defaults.values=JSON.parse(t.defaults.values)||{}}catch(o){t.defaults.values={}}}}_bindRender(o,t){o.deferred.embedded.done(()=>{setTimeout(()=>{const e=$(o.selector).find("input");e.after(t.render()),e.replaceWith($('<input type="text">').hide())})})}_bindChangeEvent(o,t){let e=_.throttle(t=>{t.values=JSON.stringify(t.values),o.setting.set(t)},50);this._bindBorderColor(o,t),t.events.on("change",e)}_bindBorderColor(o,t){let e=wp.customize.control(o.id+"_color");if("border-width"===t.controlOptions.control.name&&e){let o=o=>o.type?e.activate():e.deactivate();t.events.on("change",r=>{let s=(new PaletteSelector).getColor(e.setting()),i=t.controlOptions.control.selectors.join(",")+"{border-color:"+s+"}";r.css+=i,o(r)}),e.setting.bind(()=>t.events.emit("change",t.getSettings()))}}};