import{BorderRadius}from"@boldgrid/controls/src/controls/border-radius";import{Margin}from"@boldgrid/controls/src/controls/margin";import{Padding}from"@boldgrid/controls/src/controls/padding";import{BoxShadow}from"@boldgrid/controls/src/controls/box-shadow";import{Border}from"./border";import{MultiSlider}from"@boldgrid/controls/src/controls/multi-slider";import"../../../scss/customizer/controls/_generic.scss";var $=window.jQuery;export class Control{constructor(){this.classes={BorderRadius:BorderRadius,BoxShadow:BoxShadow,MultiSlider:MultiSlider,Border:Border,Padding:Padding,Margin:Margin}}init(){return $(()=>this._bindConfigs()),this}_bindConfigs(){wp.customize.control.each(e=>{e.params.choices&&"boldgrid_controls"===e.params.choices.name&&this._setupControl(e)})}_setupControl(e){let t,r=e.params.choices.settings||{};this._setDefaults(e,r),t=new this.classes[e.params.choices.type](r,e),this._bindRender(e,t),this._bindChangeEvent(e,t)}_setDefaults(e,t){let r=e.setting.get()||!1;if(_.isObject(r)){t.defaults=r;try{t.defaults.media=JSON.parse(t.defaults.media)||{}}catch(e){t.defaults.media={}}}}_bindRender(e,t){e.deferred.embedded.done(()=>{setTimeout(()=>{const r=$(e.selector).find("input");r.after(t.render()),r.replaceWith($('<input type="text">').hide()),this._bindDeleteEvent(e,t)})})}_bindChangeEvent(e,t){let r=_.throttle(t=>{let r={...t};r.media=JSON.stringify(r.media),e.setting.set(r)},50);t.events.on("change",r)}_bindDeleteEvent(e,t){t.events.on("deleteSettings",()=>e.setting.set(null))}};