import{Preview as PreviewUtility}from"../preview";import PaletteSelector from"../color/palette-selector";const api=wp.customize,$=jQuery,colorLib=window.net.brehaut;export class LinkPreview{constructor(){this.previewUtility=new PreviewUtility,this.paletteSelector=new PaletteSelector,this.prefixes=["bgtfw_body"],this.selectors={}}bindEvents(){$(()=>{let t=this.prefixes;for(let e of t)this.selectors[e]=this.getSelectors(e),api(`${e}_link_color`,`${e}_link_color_hover`,`${e}_link_decoration`,`${e}_link_decoration_hover`,(...t)=>{t.map(t=>{t.bind(()=>this.updateStyles(e))})})})}getSelectors(t){let e=[];return parent.wp.customize.control&&parent.wp.customize.control(`${t}_link_color`)&&(e=parent.wp.customize.control(`${t}_link_color`).params.choices.selectors),e}updateStyles(t){let e,o=this._getColor(`${t}_link_color`),r=api(`${t}_link_color_hover`)()||0,i=this._getDecoration(`${t}_link_decoration`),l=this._getDecoration(`${t}_link_decoration_hover`),n=this.selectors[t],c="";r=parseInt(r,10)/100,e=colorLib.Color(o).lightenByAmount(r).toCSS();for(let t of n)c+=`\n\t\t\t\t${t+=""} {\n\t\t\t\t\tcolor: ${o};\n\t\t\t\t\ttext-decoration: ${i};\n\t\t\t\t}\n\t\t\t\t${t}:hover,\n\t\t\t\t${t}:focus {\n\t\t\t\t\tcolor: ${e};\n\t\t\t\t\ttext-decoration: ${l};\n\t\t\t\t}\n\t\t\t`;t.replace(/_/g,"-");this.previewUtility.updateDynamicStyles(`${t}-link-inline-css`,c)}_getDecoration(t){return api(t)()?"underline":"none"}_getColor(t){let e=api(t)()||"";return this.paletteSelector.getColor(e)}}