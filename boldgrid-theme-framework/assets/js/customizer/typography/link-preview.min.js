import{Preview as PreviewUtility}from"../preview";import PaletteSelector from"../color/palette-selector";const api=wp.customize,$=jQuery,colorLib=window.net.brehaut;export class LinkPreview{constructor(){this.previewUtility=new PreviewUtility,this.paletteSelector=new PaletteSelector,this.selectors=[]}bindEvents(){$(()=>this.selectors=this.getSelectors()),api("bgtfw_body_link_color","bgtfw_body_link_color_hover","bgtfw_body_link_decoration","bgtfw_body_link_decoration_hover",(...t)=>{t.map(t=>{t.bind(()=>this.updateStyles())})})}getSelectors(){let t=["#content a"];return parent.wp.customize.control&&parent.wp.customize.control("bgtfw_body_link_color")&&(t=parent.wp.customize.control("bgtfw_body_link_color").params.choices.selectors),t}updateStyles(){let t,o=this._getColor("bgtfw_body_link_color"),e=api("bgtfw_body_link_color_hover")()||0,r=this._getDecoration("bgtfw_body_link_decoration"),i=this._getDecoration("bgtfw_body_link_decoration_hover"),n=this.selectors,l="";e=parseInt(e,10)/100,t=colorLib.Color(o).lightenByAmount(e).toCSS();for(let e of n)l+=`\n\t\t\t\t${e+=":not(.btn):not(.button-primary):not(.button-secondary)"} {\n\t\t\t\t\tcolor: ${o};\n\t\t\t\t\ttext-decoration: ${r};\n\t\t\t\t}\n\t\t\t\t${e}:hover {\n\t\t\t\t\tcolor: ${t};\n\t\t\t\t\ttext-decoration: ${i};\n\t\t\t\t}\n\t\t\t`;this.previewUtility.updateDynamicStyles("bgftw-body-link-inline-css",l)}_getDecoration(t){return api(t)()?"underline":"none"}_getColor(t){let o=api(t)()||"";return this.paletteSelector.getColor(o)}};